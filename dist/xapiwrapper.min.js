/*! xAPIWrapper v 1.11.0 | Built on 2020-09-30 01:25:48-0500 */

!function(t){"object"==typeof exports&&"undefined"!=typeof module||"function"!=typeof define||!define.amd?t():define(t)}(function(){"use strict";function t(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})}var e=setTimeout;function n(t){return t&&void 0!==t.length}function i(){}function r(t){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],p(t,this)}function o(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value)}catch(t){return void a(e.promise,t)}s(e.promise,i)}else(1===t._state?s:a)(e.promise,t._value)})):t._deferreds.push(e)}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void p(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,c(t)}catch(e){a(t,e)}}function a(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)o(t,t._deferreds[e]);t._deferreds=null}function p(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,a(e,t))})}catch(t){if(n)return;n=!0,a(e,t)}}r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var n=new this.constructor(i);return o(this,new function(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}(t,e,n)),n},r.prototype.finally=t,r.all=function(t){return new r(function(e,i){if(!n(t))return i(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(t);if(0===r.length)return e([]);var o=r.length;function s(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var a=n.then;if("function"==typeof a)return void a.call(n,function(e){s(t,e)},i)}r[t]=n,0==--o&&e(r)}catch(t){i(t)}}for(var a=0;a<r.length;a++)s(a,r[a])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,i){if(!n(t))return i(new TypeError("Promise.race accepts an array"));for(var o=0,s=t.length;o<s;o++)r.resolve(t[o]).then(e,i)})},r._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},r._unhandledRejectionFn=function(t){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var u=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();"function"!=typeof u.Promise?u.Promise=r:u.Promise.prototype.finally||(u.Promise.prototype.finally=t)}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.WHATWGFetch={})}(this,function(t){"use strict";var e="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==e&&e,n={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(n.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=ArrayBuffer.isView||function(t){return t&&i.indexOf(Object.prototype.toString.call(t))>-1};function o(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function s(t){return"string"!=typeof t&&(t=String(t)),t}function a(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n.iterable&&(e[Symbol.iterator]=function(){return e}),e}function c(t){this.map={},t instanceof c?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function p(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function u(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function l(t){var e=new FileReader,n=u(e);return e.readAsArrayBuffer(t),n}function d(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:n.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:n.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():n.arrayBuffer&&n.blob&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=d(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||r(t))?this._bodyArrayBuffer=d(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var t=p(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=p(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(l)}),this.text=function(){var t,e,n,i=p(this);if(i)return i;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=u(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),i=0;i<e.length;i++)n[i]=String.fromCharCode(e[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(t,e){t=o(t),e=s(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},c.prototype.delete=function(t){delete this.map[o(t)]},c.prototype.get=function(t){return t=o(t),this.has(t)?this.map[t]:null},c.prototype.has=function(t){return this.map.hasOwnProperty(o(t))},c.prototype.set=function(t,e){this.map[o(t)]=s(e)},c.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},c.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),a(t)},c.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),a(t)},c.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),a(t)},n.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var f=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function y(t,e){if(!(this instanceof y))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var n,i,r=(e=e||{}).body;if(t instanceof y){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new c(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new c(e.headers)),this.method=(n=e.method||this.method||"GET",i=n.toUpperCase(),f.indexOf(i)>-1?i:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache)){var o=/([?&])_=[^&]*/;if(o.test(this.url))this.url=this.url.replace(o,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function v(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(r))}}),e}function g(t,e){if(!(this instanceof g))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"",this.headers=new c(e.headers),this.url=e.url||"",this._initBody(t)}y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},h.call(y.prototype),h.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},g.error=function(){var t=new g(null,{status:0,statusText:""});return t.type="error",t};var m=[301,302,303,307,308];g.redirect=function(t,e){if(-1===m.indexOf(e))throw new RangeError("Invalid status code");return new g(null,{status:e,headers:{location:t}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function b(i,r){return new Promise(function(o,a){var p=new y(i,r);if(p.signal&&p.signal.aborted)return a(new t.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function l(){u.abort()}u.onload=function(){var t,e,n={status:u.status,statusText:u.statusText,headers:(t=u.getAllResponseHeaders()||"",e=new c,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),i=n.shift().trim();if(i){var r=n.join(":").trim();e.append(i,r)}}),e)};n.url="responseURL"in u?u.responseURL:n.headers.get("X-Request-URL");var i="response"in u?u.response:u.responseText;setTimeout(function(){o(new g(i,n))},0)},u.onerror=function(){setTimeout(function(){a(new TypeError("Network request failed"))},0)},u.ontimeout=function(){setTimeout(function(){a(new TypeError("Network request failed"))},0)},u.onabort=function(){setTimeout(function(){a(new t.DOMException("Aborted","AbortError"))},0)},u.open(p.method,function(t){try{return""===t&&e.location.href?e.location.href:t}catch(e){return t}}(p.url),!0),"include"===p.credentials?u.withCredentials=!0:"omit"===p.credentials&&(u.withCredentials=!1),"responseType"in u&&(n.blob?u.responseType="blob":n.arrayBuffer&&p.headers.get("Content-Type")&&-1!==p.headers.get("Content-Type").indexOf("application/octet-stream")&&(u.responseType="arraybuffer")),!r||"object"!=typeof r.headers||r.headers instanceof c?p.headers.forEach(function(t,e){u.setRequestHeader(e,t)}):Object.getOwnPropertyNames(r.headers).forEach(function(t){u.setRequestHeader(t,s(r.headers[t]))}),p.signal&&(p.signal.addEventListener("abort",l),u.onreadystatechange=function(){4===u.readyState&&p.signal.removeEventListener("abort",l)}),u.send(void 0===p._bodyInit?null:p._bodyInit)})}b.polyfill=!0,e.fetch||(e.fetch=b,e.Headers=c,e.Request=y,e.Response=g),t.Headers=c,t.Request=y,t.Response=g,t.fetch=b,Object.defineProperty(t,"__esModule",{value:!0})});var CryptoJS=(CryptoJS=CryptoJS||function(t,e){var n={},i=n.lib={},r=i.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var n=new t;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=i.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var s=n[o>>>2]>>>24-o%4*8&255;e[i+o>>>2]|=s<<24-(i+o)%4*8}else if(n.length>65535)for(o=0;o<r;o+=4)e[i+o>>>2]=n[o>>>2];else e.push.apply(e,n);return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],i=0;i<e;i+=4)n.push(4294967296*t.random()|0);return new o.init(n,e)}}),s=n.enc={},a=s.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var o=e[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new o.init(n,e/2)}},c=s.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var o=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new o.init(n,e)}},p=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},u=(s.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],o=0;o<n;o+=3)for(var s=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)r.push(i.charAt(s>>>6*(3-a)&63));var c=i.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(t){var e=t.length,n=this._map,i=n.charAt(64);if(i){var r=t.indexOf(i);-1!=r&&(e=r)}for(var s=[],a=0,c=0;c<e;c++)if(c%4){var p=n.indexOf(t.charAt(c-1))<<c%4*2,u=n.indexOf(t.charAt(c))>>>6-c%4*2;s[a>>>2]|=(p|u)<<24-a%4*8,a++}return o.create(s,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,s=this.blockSize,a=r/(4*s),c=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*s,p=t.min(4*c,r);if(c){for(var u=0;u<c;u+=s)this._doProcessBlock(i,u);var l=i.splice(0,c);n.sigBytes-=p}return new o.init(l,p)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0})),l=i.Hasher=u.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new d.HMAC.init(t,n).finalize(e)}}}),d=n.algo={},h=[],f=d.SHA1=l.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],c=0;c<80;c++){if(c<16)h[c]=0|t[e+c];else{var p=h[c-3]^h[c-8]^h[c-14]^h[c-16];h[c]=p<<1|p>>>31}var u=(i<<5|i>>>27)+a+h[c];u+=c<20?1518500249+(r&o|~r&s):c<40?1859775393+(r^o^s):c<60?(r&o|r&s|o&s)-1894007588:(r^o^s)-899497514,a=s,s=o,o=r<<30|r>>>2,r=i,i=u}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=l.clone.call(this);return t._hash=this._hash.clone(),t}});return n.SHA1=l._createHelper(f),n.HmacSHA1=l._createHmacHelper(f),n}(Math))||function(t,e){var n={},i=n.lib={},r=function(){},o=i.Base={extend:function(t){r.prototype=this;var e=new r;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var r=0;r<t;r++)e[i+r>>>2]|=(n[r>>>2]>>>24-r%4*8&255)<<24-(i+r)%4*8;else if(65535<n.length)for(r=0;r<t;r+=4)e[i+r>>>2]=n[r>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],i=0;i<e;i+=4)n.push(4294967296*t.random()|0);return new s.init(n,e)}}),a=n.enc={},c=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++){var r=e[i>>>2]>>>24-i%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new s.init(n,e/2)}},p=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++)n.push(String.fromCharCode(e[i>>>2]>>>24-i%4*8&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new s.init(n,e)}},u=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(p.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return p.parse(unescape(encodeURIComponent(t)))}},l=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,o=this.blockSize,a=r/(4*o);if(e=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,r=t.min(4*e,r),e){for(var c=0;c<e;c+=o)this._doProcessBlock(i,c);c=i.splice(0,e),n.sigBytes-=r}return new s.init(c,r)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=l.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new d.HMAC.init(t,n).finalize(e)}}});var d=n.algo={};return n}(Math);function toBase64(t){return CryptoJS&&CryptoJS.enc.Base64?CryptoJS.enc.Base64.stringify(CryptoJS.enc.Latin1.parse(t)):Base64.encode(t)}function toSHA1(t){return CryptoJS&&CryptoJS.SHA1?CryptoJS.SHA1(t).toString():Crypto.util.bytesToHex(Crypto.SHA1(t,{asBytes:!0}))}function toSHA256(t){if("[object ArrayBuffer]"!==Object.prototype.toString.call(t))return CryptoJS.SHA256(t).toString(CryptoJS.enc.Hex);for(var e=new Uint8Array(t),n=[],i=0;i<e.length;i+=4)n.push(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]);return CryptoJS.SHA256(CryptoJS.lib.WordArray.create(n,e.length)).toString(CryptoJS.enc.Hex)}function isDate(t){if("[object Date]"===Object.prototype.toString.call(t))var e=t;else e=new Date(t);return"[object Date]"===Object.prototype.toString.call(e)?isNaN(e.valueOf())?(ADL.XAPIWrapper.log("Invalid date String passed"),null):e:(ADL.XAPIWrapper.log("Invalid date object"),null)}!function(t){for(var e=CryptoJS,n=(r=e.lib).WordArray,i=r.Hasher,r=e.algo,o=[],s=[],a=function(t){return 4294967296*(t-(0|t))|0},c=2,p=0;64>p;){var u;t:{u=c;for(var l=t.sqrt(u),d=2;d<=l;d++)if(!(u%d)){u=!1;break t}u=!0}u&&(8>p&&(o[p]=a(t.pow(c,.5))),s[p]=a(t.pow(c,1/3)),p++),c++}var h=[];r=r.SHA256=i.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],a=n[3],c=n[4],p=n[5],u=n[6],l=n[7],d=0;64>d;d++){if(16>d)h[d]=0|t[e+d];else{var f=h[d-15],y=h[d-2];h[d]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+h[d-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+h[d-16]}f=l+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&p^~c&u)+s[d]+h[d],y=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&o^r&o),l=u,u=p,p=c,c=a+f|0,a=o,o=r,r=i,i=f+y|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+c|0,n[5]=n[5]+p|0,n[6]=n[6]+u|0,n[7]=n[7]+l|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(r),e.HmacSHA256=i._createHmacHelper(r)}(Math),function(){var t=CryptoJS,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=e.parse(n));var i=t.blockSize,r=4*i;n.sigBytes>r&&(n=t.finalize(n)),n.clamp();for(var o=this._oKey=n.clone(),s=this._iKey=n.clone(),a=o.words,c=s.words,p=0;p<i;p++)a[p]^=1549556828,c[p]^=909522486;o.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(t){if(void 0===t.TextEncoder){function e(t,e){if(String.prototype.codePointAt)return t.codePointAt(e);var n=(t=String(t)).length,i=e?Number(e):0;if(i!=i&&(i=0),!(i<0||i>=n)){var r,o=t.charCodeAt(i);return o>=55296&&o<=56319&&n>i+1&&(r=t.charCodeAt(i+1))>=56320&&r<=57343?1024*(o-55296)+r-56320+65536:o}}function n(t){switch(t||(t="utf8"),t){case"utf-8":case"utf8":break;default:throw"TextEncoder only supports utf8"}}n.prototype.encode=function(t){for(var n=new Uint8Array(3*t.length),i=-1,r=t.length,o=0;o<r;){var s=e(t,o),a=0,c=0;for(s<=127?(a=0,c=0):s<=2047?(a=6,c=192):s<=65535?(a=12,c=224):s<=2097151&&(a=18,c=240),n[i+=1]=c|s>>a,a-=6;a>=0;)n[i+=1]=128|s>>a&63,a-=6;o+=s>=65536?2:1}return n.subarray(0,i+1)},t.TextEncoder=n}if(void 0===t.TextDecoder){function i(t){if(String.fromCodePoint)return String.fromCodePoint(t);for(var e=[],n=0,i="",r=0,o=arguments.length;r!==o;++r){var s=+arguments[r];if(!(s<1114111&&s>>>0===s))throw RangeError("Invalid code point: "+s);s<=65535?n=e.push(s):(s-=65536,n=e.push(55296+(s>>10),s%1024+56320)),n>=16383&&(i+=String.fromCharCode.apply(null,e),e.length=0)}return i+String.fromCharCode.apply(null,e)}function r(t){switch(t||(t="utf8"),t){case"utf-8":case"utf8":break;default:throw"TextDecoder only supports utf8"}}r.prototype.decode=function(t){for(var e="",n=0;n<t.length;){var r=t[n],o=0,s=0;if(r<=127?(o=0,s=255&r):r<=223?(o=1,s=31&r):r<=239?(o=2,s=15&r):r<=244&&(o=3,s=7&r),t.length-n-o>0)for(var a=0;a<o;)s=s<<6|63&(r=t[n+a+1]),a+=1;else s=65533,o=t.length-n;e+=i(s),n+=o+1}return e},t.TextDecoder=r}}(this),(window.ADL=window.ADL||{}).activityTypes={assessment:"http://adlnet.gov/expapi/activities/assessment",attempt:"http://adlnet.gov/expapi/activities/attempt",course:"http://adlnet.gov/expapi/activities/course",file:"http://adlnet.gov/expapi/activities/file",cmiInteraction:"http://adlnet.gov/expapi/activities/cmi.interaction",interaction:"http://adlnet.gov/expapi/activities/interaction",lesson:"http://adlnet.gov/expapi/activities/lesson",link:"http://adlnet.gov/expapi/activities/link",media:"http://adlnet.gov/expapi/activities/media",meeting:"http://adlnet.gov/expapi/activities/meeting",module:"http://adlnet.gov/expapi/activities/module",objective:"http://adlnet.gov/expapi/activities/objective",performance:"http://adlnet.gov/expapi/activities/performance",profile:"http://adlnet.gov/expapi/activities/profile",question:"http://adlnet.gov/expapi/activities/question",simulation:"http://adlnet.gov/expapi/activities/simulation"},(window.ADL=window.ADL||{}).verbs={abandoned:{id:"https://w3id.org/xapi/adl/verbs/abandoned",display:{"en-US":"abandoned"}},answered:{id:"http://adlnet.gov/expapi/verbs/answered",display:{"de-DE":"beantwortete","en-US":"answered","fr-FR":"a répondu","es-ES":"contestó","ar-AR":"أجاب"}},asked:{id:"http://adlnet.gov/expapi/verbs/asked",display:{"de-DE":"fragte","en-US":"asked","fr-FR":"a demandé","es-ES":"preguntó","ar-AR":"طلب"}},attempted:{id:"http://adlnet.gov/expapi/verbs/attempted",display:{"de-DE":"versuchte","en-US":"attempted","fr-FR":"a essayé","es-ES":"intentó","ar-AR":"حاول"}},attended:{id:"http://adlnet.gov/expapi/verbs/attended",display:{"de-DE":"nahm teil an","en-US":"attended","fr-FR":"a suivi","es-ES":"asistió","ar-AR":"حضر"}},commented:{id:"http://adlnet.gov/expapi/verbs/commented",display:{"de-DE":"kommentierte","en-US":"commented","fr-FR":"a commenté","es-ES":"comentó","ar-AR":"علق"}},completed:{id:"http://adlnet.gov/expapi/verbs/completed",display:{"de-DE":"beendete","en-US":"completed","fr-FR":"a terminé","es-ES":"completó","ar-AR":"أكمل"}},exited:{id:"http://adlnet.gov/expapi/verbs/exited",display:{"de-DE":"verließ","en-US":"exited","fr-FR":"a quitté","es-ES":"salió","ar-AR":"خرج"}},experienced:{id:"http://adlnet.gov/expapi/verbs/experienced",display:{"de-DE":"erlebte","en-US":"experienced","fr-FR":"a éprouvé","es-ES":"experimentó","ar-AR":"شاهد"}},failed:{id:"http://adlnet.gov/expapi/verbs/failed",display:{"de-DE":"verfehlte","en-US":"failed","fr-FR":"a échoué","es-ES":"fracasó","ar-AR":"فشل"}},imported:{id:"http://adlnet.gov/expapi/verbs/imported",display:{"de-DE":"importierte","en-US":"imported","fr-FR":"a importé","es-ES":"importó","ar-AR":"مستورد"}},initialized:{id:"http://adlnet.gov/expapi/verbs/initialized",display:{"de-DE":"initialisierte","en-US":"initialized","fr-FR":"a initialisé","es-ES":"inicializó","ar-AR":"بدأ"}},interacted:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"de-DE":"interagierte","en-US":"interacted","fr-FR":"a interagi","es-ES":"interactuó","ar-AR":"تفاعل"}},launched:{id:"http://adlnet.gov/expapi/verbs/launched",display:{"de-DE":"startete","en-US":"launched","fr-FR":"a lancé","es-ES":"lanzó","ar-AR":"أطلق"}},mastered:{id:"http://adlnet.gov/expapi/verbs/mastered",display:{"de-DE":"meisterte","en-US":"mastered","fr-FR":"a maîtrisé","es-ES":"dominó","ar-AR":"أتقن"}},passed:{id:"http://adlnet.gov/expapi/verbs/passed",display:{"de-DE":"bestand","en-US":"passed","fr-FR":"a réussi","es-ES":"aprobó","ar-AR":"نجح"}},preferred:{id:"http://adlnet.gov/expapi/verbs/preferred",display:{"de-DE":"bevorzugte","en-US":"preferred","fr-FR":"a préféré","es-ES":"prefirió","ar-AR":"فضل"}},progressed:{id:"http://adlnet.gov/expapi/verbs/progressed",display:{"de-DE":"machte Fortschritt mit","en-US":"progressed","fr-FR":"a progressé","es-ES":"progresó","ar-AR":"تقدم"}},registered:{id:"http://adlnet.gov/expapi/verbs/registered",display:{"de-DE":"registrierte","en-US":"registered","fr-FR":"a enregistré","es-ES":"registró","ar-AR":"سجل"}},responded:{id:"http://adlnet.gov/expapi/verbs/responded",display:{"de-DE":"reagierte","en-US":"responded","fr-FR":"a répondu","es-ES":"respondió","ar-AR":"استجاب"}},resumed:{id:"http://adlnet.gov/expapi/verbs/resumed",display:{"de-DE":"setzte fort","en-US":"resumed","fr-FR":"a repris","es-ES":"continuó","ar-AR":"استأنف"}},satisfied:{id:"https://w3id.org/xapi/adl/verbs/satisfied",display:{"de-DE":"befriedigt","en-US":"satisfied","fr-FR":"satisfaite","es-ES":"satisfecho","ar-AR":"راض"}},scored:{id:"http://adlnet.gov/expapi/verbs/scored",display:{"de-DE":"erreichte","en-US":"scored","fr-FR":"a marqué","es-ES":"anotó","ar-AR":"سحل النقاط"}},shared:{id:"http://adlnet.gov/expapi/verbs/shared",display:{"de-DE":"teilte","en-US":"shared","fr-FR":"a partagé","es-ES":"compartió","ar-AR":"شارك"}},suspended:{id:"http://adlnet.gov/expapi/verbs/suspended",display:{"de-DE":"pausierte","en-US":"suspended","fr-FR":"a suspendu","es-ES":"aplazó","ar-AR":"علق"}},terminated:{id:"http://adlnet.gov/expapi/verbs/terminated",display:{"de-DE":"beendete","en-US":"terminated","fr-FR":"a terminé","es-ES":"terminó","ar-AR":"أنهى"}},voided:{id:"http://adlnet.gov/expapi/verbs/voided",display:{"de-DE":"entwertete","en-US":"voided","fr-FR":"a annulé","es-ES":"anuló","ar-AR":"فرغ"}},waived:{id:"https://w3id.org/xapi/adl/verbs/waived",display:{"de-DE":"verzichtet","en-US":"waived","fr-FR":"renoncé","es-ES":"renunciado","ar-AR":"تخلى"}}},Date.prototype.toISOString||function(){function t(t){var e=String(t);return 1===e.length&&(e="0"+e),e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(),function(t){o.debug=!1;var e,n=((e={endpoint:"http://localhost:8000/xapi/"}).auth="Basic "+toBase64("tom:1234"),e),i=function(e,n){function i(e){var n=document.createElement("a");if(n.href=e,n.protocol&&n.host)return n.protocol+"//"+n.host;if(n.href){var i=n.href.split("//");return i[0]+"//"+i[1].substr(0,i[1].indexOf("/"))}t.XAPIWrapper.log("Couldn't create base url from endpoint: "+e)}function o(t,e,n){t.auth="Basic "+toBase64(e+":"+n)}this.lrs=function(t){var e,n,i=["endpoint","auth","actor","registration","activity_id","grouping","activity_platform"],r=new Object;if(void 0!==(e=function(){var t,e,n,i,r;for(t=window.location.search.substr(1),e=t.split("&"),r={},i=0;i<e.length;i++)2===(n=e[i].split("=")).length&&n[0]&&(r[n[0]]=decodeURIComponent(n[1]));return r}())&&0!==Object.keys(e).length){for(var o=0;o<i.length;o++)e[n=i[o]]&&(r[n]=e[n],delete e[n]);r=a(t,r)}else r=t;return r}(e||{}),this.lrs.user&&this.lrs.password&&o(this.lrs,this.lrs.user,this.lrs.password),this.base=i(this.lrs.endpoint),this.withCredentials=!1,e&&void 0!==e.withCredentials&&(this.withCredentials=e.withCredentials),this.strictCallbacks=!1,this.strictCallbacks=e&&e.strictCallbacks,n&&r.call(this)&&window.ADL.send_request(this.lrs,this.lrs.endpoint+"about","GET",null,null,function(e){if(200==e.status)try{var n=JSON.parse(e.response),i=!1;for(var r in n.version)if(n.version.hasOwnProperty(r)&&n.version[r]==t.XAPIWrapper.xapiVersion){i=!0;break}i||t.XAPIWrapper.log("The lrs version ["+n.version+"] does not match this wrapper's XAPI version ["+t.XAPIWrapper.xapiVersion+"]")}catch(e){t.XAPIWrapper.log("The response was not an about object")}else t.XAPIWrapper.log("The request to get information about the LRS failed: "+e)},null,!1,null,this.withCredentials,!1),this.searchParams=function(){return{format:"exact"}},this.hash=function(e){if(!e)return null;try{return toSHA1(e)}catch(e){return t.XAPIWrapper.log("Error trying to hash -- "+e),null}},this.changeConfig=function(e){try{t.XAPIWrapper.log("updating lrs object with new configuration"),this.lrs=a(this.lrs,e),e.user&&e.password&&this.updateAuth(this.lrs,e.user,e.password),this.base=i(this.lrs.endpoint),this.withCredentials=e.withCredentials,this.strictCallbacks=e.strictCallbacks}catch(e){t.XAPIWrapper.log("error while changing configuration -- "+e)}},this.updateAuth=o};function r(){try{return void 0!=this.lrs.endpoint&&""!=this.lrs.endpoint}catch(t){return!1}}function o(t){if(!o.debug)return!1;try{return console.log(t),!0}catch(t){return!1}}function a(t,e){for(var n in e)if(0!=e.hasOwnProperty(n)){o(n+" : "+e[n]);try{e[n].constructor==Object?t[n]=a(t[n],e[n]):(void 0==t&&(t=new Object),t[n]=e[n])}catch(i){void 0==t&&(t=new Object),t[n]=e[n]}}return t}i.prototype.xapiVersion="1.0.1",i.prototype.prepareStatement=function(t){void 0===t.actor?t.actor=JSON.parse(this.lrs.actor):"string"==typeof t.actor&&(t.actor=JSON.parse(t.actor)),(this.lrs.grouping||this.lrs.registration||this.lrs.activity_platform)&&(t.context||(t.context={})),this.lrs.grouping&&(t.context.contextActivities||(t.context.contextActivities={}),Array.isArray(t.context.contextActivities.grouping)?t.context.contextActivities.grouping.splice(0,0,{id:this.lrs.grouping}):t.context.contextActivities.grouping=[{id:this.lrs.grouping}]),this.lrs.registration&&(t.context.registration=this.lrs.registration),this.lrs.activity_platform&&(t.context.platform=this.lrs.activity_platform)},i.prototype.testConfig=r,i.prototype.log=o,i.prototype.defaultEncoding="utf-8",i.prototype.sendStatement=async function(e,n,i){if(this.testConfig()){var r;this.prepareStatement(e),e.id?r=e.id:(r=t.ruuid(),e.id=r);var o=JSON.stringify(e),s=null;i&&i.length>0&&(s={},o=this.buildMultipartPost(e,i,s));var a=await t.send_request(this.lrs,this.lrs.endpoint+"statements","POST",o,this.lrs.auth,n,{id:r},null,s,this.withCredentials,this.strictCallbacks);if(!n)return{response:a,id:r}}},i.prototype.stringToArrayBuffer=function(e,n){return n=n||t.XAPIWrapper.defaultEncoding,new TextEncoder(n).encode(e).buffer},i.prototype.stringFromArrayBuffer=function(e,n){return n=n||t.XAPIWrapper.defaultEncoding,new TextDecoder(n).decode(e)},i.prototype.buildMultipartPost=function(t,e,n){t.attachments=[];for(var i=0;i<e.length;i++)"signature"==e[i].type&&(e[i].type={usageType:"http://adlnet.gov/expapi/attachments/signature",display:{"en-US":"A JWT signature"},description:{"en-US":"A signature proving the statement was not modified"},contentType:"application/octet-stream"}),"string"==typeof e[i].value&&(e[i].value=this.stringToArrayBuffer(e[i].value)),e[i].type.length=e[i].value.byteLength,e[i].type.sha2=toSHA256(e[i].value),t.attachments.push(e[i].type);var r=[],o=(Math.random()+" ").substring(2,10)+(Math.random()+" ").substring(2,10);n["Content-Type"]="multipart/mixed; boundary="+o;var s="\r\n",a=["--"+o,"Content-Type: application/json",'Content-Disposition: form-data; name="statement"',"",JSON.stringify(t)].join(s)+s;for(var i in r.push(a),e)if(e.hasOwnProperty(i)){var c=["--"+o,"Content-Type: "+e[i].type.contentType,"Content-Transfer-Encoding: binary","X-Experience-API-Hash: "+e[i].type.sha2].join(s)+s+s;r.push(c),r.push(e[i].value)}return r.push("\r\n--"+o+"--"+s),new Blob(r)},i.prototype.sendStatements=function(e,n){if(this.testConfig()){for(var i in e)e.hasOwnProperty(i)&&this.prepareStatement(e[i]);var r=t.send_request(this.lrs,this.lrs.endpoint+"statements","POST",JSON.stringify(e),this.lrs.auth,n,null,!1,null,this.withCredentials,this.strictCallbacks);if(!n)return r}},i.prototype.getStatements=function(e,n,i){if(this.testConfig()){var r=this.lrs.endpoint+"statements";if(n)r=this.base+n;else{var o=new Array;for(s in e)if(e.hasOwnProperty(s))if("until"==s||"since"==s){var a=new Date(e[s]);o.push(s+"="+encodeURIComponent(a.toISOString()))}else o.push(s+"="+encodeURIComponent(e[s]));o.length>0&&(r=r+"?"+o.join("&"))}var c=t.send_request(this.lrs,r,"GET",null,this.lrs.auth,i,null,!1,null,this.withCredentials,this.strictCallbacks);if(void 0===c||404==c.status)return null;try{return JSON.parse(c.response)}catch(t){return c.response}}},i.prototype.getActivities=function(e,n){if(this.testConfig()){var i=this.lrs.endpoint+"activities?activityId=<activityid>";i=i.replace("<activityid>",encodeURIComponent(e));var r=t.send_request(this.lrs,i,"GET",null,this.lrs.auth,n,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===r||404==r.status)return null;try{return JSON.parse(r.response)}catch(t){return r.response}}},i.prototype.sendState=function(e,n,i,r,s,a,c,p){if(this.testConfig()){var u=this.lrs.endpoint+"activities/state?activityId=<activity ID>&agent=<agent>&stateId=<stateid>";u=(u=(u=u.replace("<activity ID>",encodeURIComponent(e))).replace("<agent>",encodeURIComponent(JSON.stringify(n)))).replace("<stateid>",encodeURIComponent(i)),r&&(u+="&registration="+encodeURIComponent(r));var l=null;a&&c?o("Can't have both If-Match and If-None-Match"):a?l={"If-Match":t.formatHash(a)}:c&&(l={"If-None-Match":t.formatHash(c)});var d="PUT";if(!s)return this.log("No activity state was included."),!1;s instanceof Array?(s=JSON.stringify(s),(l=l||{})["Content-Type"]="application/json"):s instanceof Object?(s=JSON.stringify(s),(l=l||{})["Content-Type"]="application/json",d="POST"):(l=l||{})["Content-Type"]="application/octet-stream",t.send_request(this.lrs,u,d,s,this.lrs.auth,p,null,null,l,this.withCredentials,this.strictCallbacks)}},i.prototype.getState=function(e,n,i,r,o,s){if(this.testConfig()){var a=this.lrs.endpoint+"activities/state?activityId=<activity ID>&agent=<agent>";a=(a=a.replace("<activity ID>",encodeURIComponent(e))).replace("<agent>",encodeURIComponent(JSON.stringify(n))),i&&(a+="&stateId="+encodeURIComponent(i)),r&&(a+="&registration="+encodeURIComponent(r)),o&&null!=(o=isDate(o))&&(a+="&since="+encodeURIComponent(o.toISOString()));var c=t.send_request(this.lrs,a,"GET",null,this.lrs.auth,s,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===c||404==c.status)return null;try{return JSON.parse(c.response)}catch(t){return c.response}}},i.prototype.deleteState=function(e,n,i,r,s,a,c){if(this.testConfig()){var p=this.lrs.endpoint+"activities/state?activityId=<activity ID>&agent=<agent>&stateId=<stateid>";p=(p=(p=p.replace("<activity ID>",encodeURIComponent(e))).replace("<agent>",encodeURIComponent(JSON.stringify(n)))).replace("<stateid>",encodeURIComponent(i)),r&&(p+="&registration="+encodeURIComponent(r));var u=null;s&&a?o("Can't have both If-Match and If-None-Match"):s?u={"If-Match":t.formatHash(s)}:a&&(u={"If-None-Match":t.formatHash(a)});var l=t.send_request(this.lrs,p,"DELETE",null,this.lrs.auth,c,null,!1,u,this.withCredentials,this.strictCallbacks);if(void 0===l||404==l.status)return null;try{return JSON.parse(l.response)}catch(t){return l}}},i.prototype.sendActivityProfile=function(e,n,i,r,s,a){if(this.testConfig()){var c=this.lrs.endpoint+"activities/profile?activityId=<activity ID>&profileId=<profileid>";c=(c=c.replace("<activity ID>",encodeURIComponent(e))).replace("<profileid>",encodeURIComponent(n));var p=null;r&&s?o("Can't have both If-Match and If-None-Match"):r?p={"If-Match":t.formatHash(r)}:s&&(p={"If-None-Match":t.formatHash(s)});var u="PUT";if(!i)return this.log("No activity profile was included."),!1;i instanceof Array?(i=JSON.stringify(i),(p=p||{})["Content-Type"]="application/json"):i instanceof Object?(i=JSON.stringify(i),(p=p||{})["Content-Type"]="application/json",u="POST"):(p=p||{})["Content-Type"]="application/octet-stream",t.send_request(this.lrs,c,u,i,this.lrs.auth,a,null,!1,p,this.withCredentials,this.strictCallbacks)}},i.prototype.getActivityProfile=function(e,n,i,r){if(this.testConfig()){var o=this.lrs.endpoint+"activities/profile?activityId=<activity ID>";o=o.replace("<activity ID>",encodeURIComponent(e)),n&&(o+="&profileId="+encodeURIComponent(n)),i&&null!=(i=isDate(i))&&(o+="&since="+encodeURIComponent(i.toISOString()));var s=t.send_request(this.lrs,o,"GET",null,this.lrs.auth,r,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===s||404==s.status)return null;try{return JSON.parse(s.response)}catch(t){return s.response}}},i.prototype.deleteActivityProfile=function(e,n,i,r,s){if(this.testConfig()){var a=this.lrs.endpoint+"activities/profile?activityId=<activity ID>&profileId=<profileid>";a=(a=a.replace("<activity ID>",encodeURIComponent(e))).replace("<profileid>",encodeURIComponent(n));var c=null;i&&r?o("Can't have both If-Match and If-None-Match"):i?c={"If-Match":t.formatHash(i)}:r&&(c={"If-None-Match":t.formatHash(r)});var p=t.send_request(this.lrs,a,"DELETE",null,this.lrs.auth,s,null,!1,c,this.withCredentials,this.strictCallbacks);if(void 0===p||404==p.status)return null;try{return JSON.parse(p.response)}catch(t){return p}}},i.prototype.getAgents=function(e,n){if(this.testConfig()){var i=this.lrs.endpoint+"agents?agent=<agent>";i=i.replace("<agent>",encodeURIComponent(JSON.stringify(e)));var r=t.send_request(this.lrs,i,"GET",null,this.lrs.auth,n,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===r||404==r.status)return null;try{return JSON.parse(r.response)}catch(t){return r.response}}},i.prototype.sendAgentProfile=function(e,n,i,r,s,a){if(this.testConfig()){var c=this.lrs.endpoint+"agents/profile?agent=<agent>&profileId=<profileid>";c=(c=c.replace("<agent>",encodeURIComponent(JSON.stringify(e)))).replace("<profileid>",encodeURIComponent(n));var p=null;r&&s?o("Can't have both If-Match and If-None-Match"):r?p={"If-Match":t.formatHash(r)}:s&&(p={"If-None-Match":t.formatHash(s)});var u="PUT";if(!i)return this.log("No agent profile was included."),!1;i instanceof Array?(i=JSON.stringify(i),(p=p||{})["Content-Type"]="application/json"):i instanceof Object?(i=JSON.stringify(i),(p=p||{})["Content-Type"]="application/json",u="POST"):(p=p||{})["Content-Type"]="application/octet-stream",t.send_request(this.lrs,c,u,i,this.lrs.auth,a,null,!1,p,this.withCredentials,this.strictCallbacks)}},i.prototype.getAgentProfile=function(e,n,i,r){if(this.testConfig()){var o=this.lrs.endpoint+"agents/profile?agent=<agent>";o=(o=o.replace("<agent>",encodeURIComponent(JSON.stringify(e)))).replace("<profileid>",encodeURIComponent(n)),n&&(o+="&profileId="+encodeURIComponent(n)),i&&null!=(i=isDate(i))&&(o+="&since="+encodeURIComponent(i.toISOString()));var s=t.send_request(this.lrs,o,"GET",null,this.lrs.auth,r,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===s||404==s.status)return null;try{return JSON.parse(s.response)}catch(t){return s.response}}},i.prototype.deleteAgentProfile=function(e,n,i,r,s){if(this.testConfig()){var a=this.lrs.endpoint+"agents/profile?agent=<agent>&profileId=<profileid>";a=(a=a.replace("<agent>",encodeURIComponent(JSON.stringify(e)))).replace("<profileid>",encodeURIComponent(n));var c=null;i&&r?o("Can't have both If-Match and If-None-Match"):i?c={"If-Match":t.formatHash(i)}:r&&(c={"If-None-Match":t.formatHash(r)});var p=t.send_request(this.lrs,a,"DELETE",null,this.lrs.auth,s,null,!1,c,this.withCredentials,this.strictCallbacks);if(void 0===p||404==p.status)return null;try{return JSON.parse(p.response)}catch(t){return p}}},t.ruuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},t.dateFromISOString=function(t){var e=t.match(new RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T| ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),n=0,i=new Date(e[1],0,1);e[3]&&i.setMonth(e[3]-1),e[5]&&i.setDate(e[5]),e[7]&&i.setHours(e[7]),e[8]&&i.setMinutes(e[8]),e[10]&&i.setSeconds(e[10]),e[12]&&i.setMilliseconds(1e3*Number("0."+e[12])),e[14]&&(n=60*Number(e[16])+Number(e[17]),n*="-"==e[15]?1:-1),n-=i.getTimezoneOffset(),time=Number(i)+60*n*1e3;var r=new Date;return r.setTime(Number(time)),r},t.send_request=async function(e,n,i,r,o,s,a,c,p,u,l){"use strict";var d,h,f=n.toLowerCase().match(/^(.+):\/\/([^:\/]*):?(\d+)?(\/.*)?$/),y=window.location,v={"Content-Type":"application/json"};if(v.Authorization=o,v["X-Experience-API-Version"]=t.XAPIWrapper.xapiVersion,null!==p)for(var g in p)p.hasOwnProperty(g)&&(v[g]=p[g]);if(y.protocol.toLowerCase()!==f[1]||y.hostname.toLowerCase()!==f[2]||(null===f[3]?"http"===f[1]?"80":"443":f[3])===y.port,null!==e&&void 0!==e.extended){for(h in d=new Array,e.extended)d.push(h+"="+encodeURIComponent(e.extended[h]));d.length>0&&(n+=(n.indexOf("?")>-1?"&":"?")+d.join("&"))}try{var m=await fetch(n,{method:i,mode:"cors",cache:"no-cache",credentials:u?"include":"same-origin",headers:v,body:r}),b=!c&&404===m.status,w=(m.status<200||m.status>400)&&404!==m.status;if(void 0===m.status||w||b)throw new Error(m.statusText);var S=await m.json();return s&&(a?l?s(null,m,a):s(m,a):l?s(null,m,S):s(m,S)),m}catch(e){var x;try{x="There was a problem communicating with the Learning Record Store. ( "+m.status+" | "+m.statusText+" )"+n}catch(t){x=t.toString()}t.XAPIWrapper.log(x),t.errorOnRequest(m,s,a,l)}},t.errorOnRequest=function(t,e,n,i){if(e&&i){var r,o=t?t.status:void 0;if(r=o?new Error("Request error: "+t.status):0===o||null===o?new Error("Request error: aborted"):new Error("Reqeust error: unknown"),n)e(r,t,n);else{var s;try{s=JSON.parse(t.statusText)}catch(e){s=t.statusText}e(r,t,s)}}},t.formatHash=function(t){return"*"===t?t:'"'+t+'"'},t.XAPIWrapper=new i(n,!1)}(window.ADL=window.ADL||{}),function(t){function e(t,n){var i=n.split("."),r=i[0];return n=i.slice(1).join("."),t[r]||(/\[\]$/.test(r)?(r=r.slice(0,-2),Array.isArray(t[r])||(t[r]=[])):t[r]={}),n?e(t[r],n):t[r]}var n=function(e,n,p,u){if(e&&e.actor&&e.verb&&e.object){var l=e;for(var d in l)"actor"!=d&&"verb"!=d&&"object"!=d&&(this[d]=l[d]);e=l.actor,n=l.verb,p=l.object}e?e instanceof i?this.actor=e:"Agent"!==e.objectType&&e.objectType?"Group"===e.objectType&&(this.actor=new r(e)):this.actor=new i(e):this.actor=null,this.verb=n?n instanceof o?n:new o(n):null,p?"Activity"!==p.objectType&&p.objectType?"Agent"===p.objectType?this.object=p instanceof i?p:new i(p):"Group"===p.objectType?this.object=p instanceof r?p:new r(p):"StatementRef"===p.objectType?this.object=p instanceof a?p:new a(p):"SubStatement"===p.objectType?this.object=p instanceof c?p:new c(p):this.object=null:this.object=p instanceof s?p:new s(p):this.object=null,u&&(this.result=u),this.generateId=function(){this.id=t.ruuid()}};n.prototype.toString=function(){return this.actor.toString()+" "+this.verb.toString()+" "+this.object.toString()+" "+this.result.toString()},n.prototype.isValid=function(){return this.actor&&this.actor.isValid()&&this.verb&&this.verb.isValid()&&this.object&&this.object.isValid()&&this.result&&this.result.isValid()},n.prototype.generateRegistration=function(){e(this,"context").registration=t.ruuid()},n.prototype.addParentActivity=function(t){e(this,"context.contextActivities.parent[]").push(new s(t))},n.prototype.addGroupingActivity=function(t){e(this,"context.contextActivities.grouping[]").push(new s(t))},n.prototype.addOtherContextActivity=function(t){e(this,"context.contextActivities.other[]").push(new s(t))};var i=function(t,e){if(this.objectType="Agent",this.name=e,t&&(t.mbox||t.mbox_sha1sum||t.openid||t.account))for(var n in t)this[n]=t[n];else/^mailto:/.test(t)?this.mbox=t:/^[0-9a-f]{40}$/i.test(t)?this.mbox_sha1sum=t:/^http[s]?:/.test(t)?this.openid=t:t&&t.homePage&&t.name&&(this.account=t)};i.prototype.toString=function(){return this.name||this.mbox||this.openid||this.mbox_sha1sum||this.account.name},i.prototype.isValid=function(){return this.mbox||this.mbox_sha1sum||this.openid||this.account.homePage&&this.account.name||"Group"===this.objectType&&this.member};var r=function(t,e,n){i.call(this,t,n),this.member=e,this.objectType="Group"};r.prototype=new i;var o=function(t,e){if(t&&t.id)for(var n in t)this[n]=t[n];else this.id=t,e&&("string"==typeof e||e instanceof String?this.display={"en-US":e}:this.display=e)};o.prototype.toString=function(){return this.display&&(this.display["en-US"]||this.display.en)?this.display["en-US"]||this.display.en:this.id},o.prototype.isValid=function(){return this.id};var s=function(t,e,n){if(t&&t.id){var i=t;for(var r in i)this[r]=i[r]}else this.objectType="Activity",this.id=t,(e||n)&&(this.definition={},"string"==typeof e||e instanceof String?this.definition.name={"en-US":e}:e&&(this.definition.name=e),"string"==typeof n||n instanceof String?this.definition.description={"en-US":n}:n&&(this.definition.description=n))};s.prototype.toString=function(){return this.definition&&this.definition.name&&(this.definition.name["en-US"]||this.definition.name.en)?this.definition.name["en-US"]||this.definition.name.en:this.id},s.prototype.isValid=function(){return this.id&&(!this.objectType||"Activity"===this.objectType)};var a=function(t){if(t&&t.id)for(var e in t)this[e]=t[e];else this.objectType="StatementRef",this.id=t};a.prototype.toString=function(){return"statement("+this.id+")"},a.prototype.isValid=function(){return this.id&&this.objectType&&"StatementRef"===this.objectType};var c=function(t,e,i){n.call(this,t,e,i),this.objectType="SubStatement",delete this.id,delete this.stored,delete this.version,delete this.authority};c.prototype=new n,c.prototype.toString=function(){return'"'+c.prototype.prototype.toString.call(this)+'"'},n.Agent=i,n.Group=r,n.Verb=o,n.Activity=s,n.StatementRef=a,n.SubStatement=c,t.XAPIStatement=n}(window.ADL=window.ADL||{}),function(t){var e=t,n=!1;"undefined"!=typeof window&&(e=window.ADL=t.ADL||{},n=!0);var i=function(t){if("SubStatement"===t.objectType&&("SubStatement"!==t.object.objectType&&!(t.id||t.stored||t.version||t.authority)))return e.xapiutil.getActorId(t.actor)+":"+e.xapiutil.getVerbDisplay(t.verb)+":"+e.xapiutil.getObjectId(t.object)};e.xapiutil={},e.xapiutil.getLang=function(){var t;if("undefined"!=typeof navigator)t=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;else if("undefined"!=typeof process&&void 0!==process.env&&void 0!==process.env.LANG){var e=process.env.LANG;t=(t=e.slice(0,e.indexOf("."))).replace(/_/,"-")}return t||"en-US"},e.xapiutil.getLangVal=function(t){if(t&&0!=Object.keys(t).length){var n,i=e.xapiutil.getLang(),r=!1;do{t[i]?(n=t[i],r=!0):i.indexOf("-")&&(i=i.substring(0,i.lastIndexOf("-")))}while(!r&&""!==i);return n}},e.xapiutil.getMoreStatements=function(t,i,r){if(!n)throw new Error("Node not supported.");var o=[];e.XAPIWrapper.getStatements(r,null,function n(s){if(s&&s.response){var a=JSON.parse(s.response);a.statements&&(o=o.concat(a.statements),t--<=0?i(o):a.more&&""!==a.more?e.XAPIWrapper.getStatements(r,a.more,n):""===a.more&&i(o))}})},e.xapiutil.getActorId=function(t){return t.mbox||t.openid||t.mbox_sha1sum||t.account},e.xapiutil.getActorIdString=function(t){var e=t.mbox||t.openid||t.mbox_sha1sum;return e||(e=t.account?t.account.homePage+":"+t.account.name:t.member?"Anon Group "+t.member:"unknown"),e},e.xapiutil.getActorDisplay=function(t){return t.name||e.xapiutil.getActorIdString(t)},e.xapiutil.getVerbDisplay=function(t){if(t)return t.display&&e.xapiutil.getLangVal(t.display)||t.id},e.xapiutil.getObjectType=function(t){return t.objectType||(t.id?"Activity":"Agent")},e.xapiutil.getObjectId=function(t){if(t.id)return t.id;var n=e.xapiutil.getObjectType(t);return"Agent"===n||"Group"===n?e.xapiutil.getActorId(t):void 0},e.xapiutil.getObjectIdString=function(t){if(!t)return"unknown";if(t.id)return t.id;var n=e.xapiutil.getObjectType(t);return"Agent"===n||"Group"===n?e.xapiutil.getActorIdString(t):"SubStatement"==n?i(t):"unknown"},e.xapiutil.getObjectDisplay=function(t){if(!t)return"unknown";var n=function(t){if(t.definition&&t.definition.name)return e.xapiutil.getLangVal(t.definition.name)}(t)||t.name||t.id;if(!n){var r=e.xapiutil.getObjectType(t);"Agent"===r||"Group"==r?n=e.xapiutil.getActorDisplay(t):"SubStatement"==r&&(n=i(t))}return n}}(this),function(t){var e=window.ADL=window.ADL||{};function n(t){for(var e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){var i=e[n].split("=");if(decodeURIComponent(i[0])==t)return decodeURIComponent(i[1])}}function i(t){var e="xAPILaunchKey="+n("xAPILaunchKey")+"&xAPILaunchService="+n("xAPILaunchService");n("encrypted")&&(e+="&encrypted=true");for(var i=0;i<t.length;i++){var r=t[i],o=r.href,s=r.attributes.getNamedItem("courselink");s&&"true"==s.value&&(o=o.indexOf("?")>-1?o+"&"+e:o+"?"+e,r.href=o)}}e.launch=async function t(r,o,s){r=function(t){return function(){var e=arguments;window.setTimeout(function(){for(var n=[],i=0;i<e.length;i++)n.push(e[i]);t.apply(window,n)},0)}}(r);try{var a=n("xAPILaunchKey"),c=n("xAPILaunchService");if(n("encrypted"),t.terminate=async function(t){var e=new URL(c);e.pathname+="launch/"+a+"/terminate";try{const n=await fetch(e.toString(),{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:0,description:t||"User closed content"})});await n.json()}catch(t){}},!a||!c)return r("invalid launch parameters");var p=new URL(c);p.pathname+="launch/"+a;try{const n=await fetch(p.toString(),{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:0,description:message||"User closed content"})});if(200!==!n.status)throw new Error(status.statusText);var u=await n.json(),l=u,d={};d.endpoint=l.endpoint,d.actor=l.actor,d.withCredentials=!0,d.strictCallbacks=s||!1,window.onunload=function(){o&&t.terminate("User closed content")};var h=new e.XAPIWrapper.constructor;return h.changeConfig(d),i(document.body.querySelectorAll("a")),f=document.body,new MutationObserver(function(t){t.forEach(function(t){for(var e in t.addedNodes)t.addedNodes.hasOwnProperty(e)&&t.addedNodes[e].constructor==HTMLAnchorElement&&i([t.addedNodes[e]])})}).observe(f,{attributes:!0,childList:!0,subtree:!0}),r(null,u,h)}catch(t){window.setTimeout(function(){return r(t)})}}catch(t){r(t)}var f}}();
//# sourceMappingURL=xapiwrapper.min.js.map
/*! xAPIWrapper v 1.10.1 | Built on 2019-02-07 23:23:13+0000 */
(function(root, factory){
    // text-encoder uses module.exports which isn't allowed inside
    // the main closure as it breaks the module export in node
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(['exports'], function (exports) {
            factory({}, { ADL: exports }, root);
        });
    } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {
        // CommonJS
        factory({}, { ADL: exports }, root);
    } else {
        // Browser roots
        factory({}, root, root);
    }
}(typeof self !== 'undefined' ? self : this, function (module, window, root) {
!function(i){"use strict";function m(t,e,n){return e<=t&&t<=n}"undefined"!=typeof module&&module.exports&&!i["encoding-indexes"]&&(i["encoding-indexes"]=require("./encoding-indexes.js")["encoding-indexes"]);var l=Math.floor;function a(t){if(void 0===t)return{};if(t===Object(t))return t;throw TypeError("Could not convert argument to dictionary")}function d(t){return 0<=t&&t<=127}var c=d,b=-1;function u(t){this.tokens=[].slice.call(t),this.tokens.reverse()}u.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.pop():b},prepend:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.push(e.pop());else this.tokens.push(t)},push:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.unshift(e.shift());else this.tokens.unshift(t)}};var w=-1;function S(t,e){if(t)throw TypeError("Decoder error");return e||65533}function p(t){throw TypeError("The code point "+t+" could not be encoded.")}function r(t){return t=String(t).trim().toLowerCase(),Object.prototype.hasOwnProperty.call(n,t)?n[t]:null}var t=[{encodings:[{labels:["unicode-1-1-utf-8","utf-8","utf8"],name:"UTF-8"}],heading:"The Encoding"},{encodings:[{labels:["866","cp866","csibm866","ibm866"],name:"IBM866"},{labels:["csisolatin2","iso-8859-2","iso-ir-101","iso8859-2","iso88592","iso_8859-2","iso_8859-2:1987","l2","latin2"],name:"ISO-8859-2"},{labels:["csisolatin3","iso-8859-3","iso-ir-109","iso8859-3","iso88593","iso_8859-3","iso_8859-3:1988","l3","latin3"],name:"ISO-8859-3"},{labels:["csisolatin4","iso-8859-4","iso-ir-110","iso8859-4","iso88594","iso_8859-4","iso_8859-4:1988","l4","latin4"],name:"ISO-8859-4"},{labels:["csisolatincyrillic","cyrillic","iso-8859-5","iso-ir-144","iso8859-5","iso88595","iso_8859-5","iso_8859-5:1988"],name:"ISO-8859-5"},{labels:["arabic","asmo-708","csiso88596e","csiso88596i","csisolatinarabic","ecma-114","iso-8859-6","iso-8859-6-e","iso-8859-6-i","iso-ir-127","iso8859-6","iso88596","iso_8859-6","iso_8859-6:1987"],name:"ISO-8859-6"},{labels:["csisolatingreek","ecma-118","elot_928","greek","greek8","iso-8859-7","iso-ir-126","iso8859-7","iso88597","iso_8859-7","iso_8859-7:1987","sun_eu_greek"],name:"ISO-8859-7"},{labels:["csiso88598e","csisolatinhebrew","hebrew","iso-8859-8","iso-8859-8-e","iso-ir-138","iso8859-8","iso88598","iso_8859-8","iso_8859-8:1988","visual"],name:"ISO-8859-8"},{labels:["csiso88598i","iso-8859-8-i","logical"],name:"ISO-8859-8-I"},{labels:["csisolatin6","iso-8859-10","iso-ir-157","iso8859-10","iso885910","l6","latin6"],name:"ISO-8859-10"},{labels:["iso-8859-13","iso8859-13","iso885913"],name:"ISO-8859-13"},{labels:["iso-8859-14","iso8859-14","iso885914"],name:"ISO-8859-14"},{labels:["csisolatin9","iso-8859-15","iso8859-15","iso885915","iso_8859-15","l9"],name:"ISO-8859-15"},{labels:["iso-8859-16"],name:"ISO-8859-16"},{labels:["cskoi8r","koi","koi8","koi8-r","koi8_r"],name:"KOI8-R"},{labels:["koi8-ru","koi8-u"],name:"KOI8-U"},{labels:["csmacintosh","mac","macintosh","x-mac-roman"],name:"macintosh"},{labels:["dos-874","iso-8859-11","iso8859-11","iso885911","tis-620","windows-874"],name:"windows-874"},{labels:["cp1250","windows-1250","x-cp1250"],name:"windows-1250"},{labels:["cp1251","windows-1251","x-cp1251"],name:"windows-1251"},{labels:["ansi_x3.4-1968","ascii","cp1252","cp819","csisolatin1","ibm819","iso-8859-1","iso-ir-100","iso8859-1","iso88591","iso_8859-1","iso_8859-1:1987","l1","latin1","us-ascii","windows-1252","x-cp1252"],name:"windows-1252"},{labels:["cp1253","windows-1253","x-cp1253"],name:"windows-1253"},{labels:["cp1254","csisolatin5","iso-8859-9","iso-ir-148","iso8859-9","iso88599","iso_8859-9","iso_8859-9:1989","l5","latin5","windows-1254","x-cp1254"],name:"windows-1254"},{labels:["cp1255","windows-1255","x-cp1255"],name:"windows-1255"},{labels:["cp1256","windows-1256","x-cp1256"],name:"windows-1256"},{labels:["cp1257","windows-1257","x-cp1257"],name:"windows-1257"},{labels:["cp1258","windows-1258","x-cp1258"],name:"windows-1258"},{labels:["x-mac-cyrillic","x-mac-ukrainian"],name:"x-mac-cyrillic"}],heading:"Legacy single-byte encodings"},{encodings:[{labels:["chinese","csgb2312","csiso58gb231280","gb2312","gb_2312","gb_2312-80","gbk","iso-ir-58","x-gbk"],name:"GBK"},{labels:["gb18030"],name:"gb18030"}],heading:"Legacy multi-byte Chinese (simplified) encodings"},{encodings:[{labels:["big5","big5-hkscs","cn-big5","csbig5","x-x-big5"],name:"Big5"}],heading:"Legacy multi-byte Chinese (traditional) encodings"},{encodings:[{labels:["cseucpkdfmtjapanese","euc-jp","x-euc-jp"],name:"EUC-JP"},{labels:["csiso2022jp","iso-2022-jp"],name:"ISO-2022-JP"},{labels:["csshiftjis","ms932","ms_kanji","shift-jis","shift_jis","sjis","windows-31j","x-sjis"],name:"Shift_JIS"}],heading:"Legacy multi-byte Japanese encodings"},{encodings:[{labels:["cseuckr","csksc56011987","euc-kr","iso-ir-149","korean","ks_c_5601-1987","ks_c_5601-1989","ksc5601","ksc_5601","windows-949"],name:"EUC-KR"}],heading:"Legacy multi-byte Korean encodings"},{encodings:[{labels:["csiso2022kr","hz-gb-2312","iso-2022-cn","iso-2022-cn-ext","iso-2022-kr"],name:"replacement"},{labels:["utf-16be"],name:"UTF-16BE"},{labels:["utf-16","utf-16le"],name:"UTF-16LE"},{labels:["x-user-defined"],name:"x-user-defined"}],heading:"Legacy miscellaneous encodings"}],n={};t.forEach(function(t){t.encodings.forEach(function(e){e.labels.forEach(function(t){n[t]=e})})});var s,h,f={},g={};function x(t,e){return e&&e[t]||null}function v(t,e){var n=e.indexOf(t);return-1===n?null:n}function _(t){if(!("encoding-indexes"in i))throw Error("Indexes missing. Did you forget to include encoding-indexes.js first?");return i["encoding-indexes"][t]}var o="utf-8";function y(t,e){if(!(this instanceof y))throw TypeError("Called as a function. Did you forget 'new'?");t=void 0!==t?String(t):o,e=a(e),this._encoding=null,this._decoder=null,this._ignoreBOM=!1,this._BOMseen=!1,this._error_mode="replacement",this._do_not_flush=!1;var n=r(t);if(null===n||"replacement"===n.name)throw RangeError("Unknown encoding: "+t);if(!g[n.name])throw Error("Decoder not present. Did you forget to include encoding-indexes.js first?");var i=this;return i._encoding=n,Boolean(e.fatal)&&(i._error_mode="fatal"),Boolean(e.ignoreBOM)&&(i._ignoreBOM=!0),Object.defineProperty||(this.encoding=i._encoding.name.toLowerCase(),this.fatal="fatal"===i._error_mode,this.ignoreBOM=i._ignoreBOM),i}function C(t,e){if(!(this instanceof C))throw TypeError("Called as a function. Did you forget 'new'?");e=a(e),this._encoding=null,this._encoder=null,this._do_not_flush=!1,this._fatal=Boolean(e.fatal)?"fatal":"replacement";if(Boolean(e.NONSTANDARD_allowLegacyEncoding)){var n=r(t=void 0!==t?String(t):o);if(null===n||"replacement"===n.name)throw RangeError("Unknown encoding: "+t);if(!f[n.name])throw Error("Encoder not present. Did you forget to include encoding-indexes.js first?");this._encoding=n}else this._encoding=r("utf-8"),void 0!==t&&"console"in i&&console.warn("TextEncoder constructor called with encoding label, which is ignored.");return Object.defineProperty||(this.encoding=this._encoding.name.toLowerCase()),this}function e(t){var i=t.fatal,r=0,o=0,s=0,a=128,l=191;this.handler=function(t,e){if(e===b&&0!==s)return s=0,S(i);if(e===b)return w;if(0===s){if(m(e,0,127))return e;if(m(e,194,223))s=1,r=31&e;else if(m(e,224,239))224===e&&(a=160),237===e&&(l=159),s=2,r=15&e;else{if(!m(e,240,244))return S(i);240===e&&(a=144),244===e&&(l=143),s=3,r=7&e}return null}if(!m(e,a,l))return r=s=o=0,a=128,l=191,t.prepend(e),S(i);if(a=128,l=191,r=r<<6|63&e,(o+=1)!==s)return null;var n=r;return r=s=o=0,n}}function A(t){t.fatal;this.handler=function(t,e){if(e===b)return w;if(c(e))return e;var n,i;m(e,128,2047)?(n=1,i=192):m(e,2048,65535)?(n=2,i=224):m(e,65536,1114111)&&(n=3,i=240);for(var r=[(e>>6*n)+i];0<n;){var o=e>>6*(n-1);r.push(128|63&o),n-=1}return r}}function I(i,t){var r=t.fatal;this.handler=function(t,e){if(e===b)return w;if(d(e))return e;var n=i[e-128];return null===n?S(r):n}}function O(i,t){t.fatal;this.handler=function(t,e){if(e===b)return w;if(c(e))return e;var n=v(e,i);return null===n&&p(e),n+128}}function R(t){var a=t.fatal,l=0,c=0,u=0;this.handler=function(t,e){if(e===b&&0===l&&0===c&&0===u)return w;var n;if(e!==b||0===l&&0===c&&0===u||(u=c=l=0,S(a)),0!==u){n=null,m(e,48,57)&&(n=function(t){if(39419<t&&t<189e3||1237575<t)return null;if(7457===t)return 59335;var e,n=0,i=0,r=_("gb18030-ranges");for(e=0;e<r.length;++e){var o=r[e];if(!(o[0]<=t))break;n=o[0],i=o[1]}return i+t-n}(10*(126*(10*(l-129)+c-48)+u-129)+e-48));var i=[c,u,e];return u=c=l=0,null===n?(t.prepend(i),S(a)):n}if(0!==c)return m(e,129,254)?(u=e,null):(t.prepend([c,e]),c=l=0,S(a));if(0===l)return d(e)?e:128===e?8364:m(e,129,254)?(l=e,null):S(a);if(m(e,48,57))return c=e,null;var r=l,o=null;l=0;var s=e<127?64:65;return(m(e,64,126)||m(e,128,254))&&(o=190*(r-129)+(e-s)),null===(n=null===o?null:x(o,_("gb18030")))&&d(e)&&t.prepend(e),null===n?S(a):n}}function T(t,a){t.fatal;this.handler=function(t,e){if(e===b)return w;if(c(e))return e;if(58853===e)return p(e);if(a&&8364===e)return 128;var n=v(e,_("gb18030"));if(null!==n){var i=n%190;return[l(n/190)+129,i+(i<63?64:65)]}if(a)return p(e);n=function(t){if(59335===t)return 7457;var e,n=0,i=0,r=_("gb18030-ranges");for(e=0;e<r.length;++e){var o=r[e];if(!(o[1]<=t))break;n=o[1],i=o[0]}return i+t-n}(e);var r=l(n/10/126/10),o=l((n-=10*r*126*10)/10/126),s=l((n-=10*o*126)/10);return[r+129,o+48,s+129,n-10*s+48]}}function E(t){var s=t.fatal,a=0;this.handler=function(t,e){if(e===b&&0!==a)return a=0,S(s);if(e===b&&0===a)return w;if(0===a)return d(e)?e:m(e,129,254)?(a=e,null):S(s);var n=a,i=null;a=0;var r=e<127?64:98;switch((m(e,64,126)||m(e,161,254))&&(i=157*(n-129)+(e-r)),i){case 1133:return[202,772];case 1135:return[202,780];case 1164:return[234,772];case 1166:return[234,780]}var o=null===i?null:x(i,_("big5"));return null===o&&d(e)&&t.prepend(e),null===o?S(s):o}}function U(t){t.fatal;this.handler=function(t,e){if(e===b)return w;if(c(e))return e;var n,i,r=(n=e,i=h=h||_("big5").map(function(t,e){return e<5024?null:t}),9552===n||9566===n||9569===n||9578===n||21313===n||21317===n?i.lastIndexOf(n):v(n,i));if(null===r)return p(e);var o=l(r/157)+129;if(o<161)return p(e);var s=r%157;return[o,s+(s<63?64:98)]}}function j(t){var r=t.fatal,o=!1,s=0;this.handler=function(t,e){if(e===b&&0!==s)return s=0,S(r);if(e===b&&0===s)return w;if(142===s&&m(e,161,223))return s=0,65216+e;if(143===s&&m(e,161,254))return o=!0,s=e,null;if(0===s)return d(e)?e:142===e||143===e||m(e,161,254)?(s=e,null):S(r);var n=s;s=0;var i=null;return m(n,161,254)&&m(e,161,254)&&(i=x(94*(n-161)+(e-161),_(o?"jis0212":"jis0208"))),o=!1,m(e,161,254)||t.prepend(e),null===i?S(r):i}}function D(t){t.fatal;this.handler=function(t,e){if(e===b)return w;if(c(e))return e;if(165===e)return 92;if(8254===e)return 126;if(m(e,65377,65439))return[142,e-65377+161];8722===e&&(e=65293);var n=v(e,_("jis0208"));return null===n?p(e):[l(n/94)+161,n%94+161]}}function B(t){var s=t.fatal,a=0,l=1,c=2,u=3,d=4,p=5,h=6,f=a,g=a,v=0,y=!1;this.handler=function(t,e){switch(f){default:case a:return 27===e?(f=p,null):m(e,0,127)&&14!==e&&15!==e&&27!==e?(y=!1,e):e===b?w:(y=!1,S(s));case l:return 27===e?(f=p,null):92===e?(y=!1,165):126===e?(y=!1,8254):m(e,0,127)&&14!==e&&15!==e&&27!==e&&92!==e&&126!==e?(y=!1,e):e===b?w:(y=!1,S(s));case c:return 27===e?(f=p,null):m(e,33,95)?(y=!1,65344+e):e===b?w:(y=!1,S(s));case u:return 27===e?(f=p,null):m(e,33,126)?(y=!1,v=e,f=d,null):e===b?w:(y=!1,S(s));case d:if(27===e)return f=p,S(s);if(m(e,33,126)){f=u;var n=x(94*(v-33)+e-33,_("jis0208"));return null===n?S(s):n}return e===b?(f=u,t.prepend(e)):f=u,S(s);case p:return 36===e||40===e?(v=e,f=h,null):(t.prepend(e),y=!1,f=g,S(s));case h:var i=v;v=0;var r=null;if(40===i&&66===e&&(r=a),40===i&&74===e&&(r=l),40===i&&73===e&&(r=c),36!==i||64!==e&&66!==e||(r=u),null===r)return t.prepend([i,e]),y=!1,f=g,S(s);f=f=r;var o=y;return y=!0,o?S(s):null}}}function k(t){t.fatal;var i=0,r=1,o=2,s=i;this.handler=function(t,e){if(e===b&&s!==i)return t.prepend(e),s=i,[27,40,66];if(e===b&&s===i)return w;if(!(s!==i&&s!==r||14!==e&&15!==e&&27!==e))return p(65533);if(s===i&&c(e))return e;if(s===r&&(c(e)&&92!==e&&126!==e||165==e||8254==e)){if(c(e))return e;if(165===e)return 92;if(8254===e)return 126}if(c(e)&&s!==i)return t.prepend(e),s=i,[27,40,66];if((165===e||8254===e)&&s!==r)return t.prepend(e),s=r,[27,40,74];8722===e&&(e=65293);var n=v(e,_("jis0208"));return null===n?p(e):s!==o?(t.prepend(e),s=o,[27,36,66]):[l(n/94)+33,n%94+33]}}function P(t){var a=t.fatal,l=0;this.handler=function(t,e){if(e===b&&0!==l)return l=0,S(a);if(e===b&&0===l)return w;if(0===l)return d(e)||128===e?e:m(e,161,223)?65216+e:m(e,129,159)||m(e,224,252)?(l=e,null):S(a);var n=l,i=null;l=0;var r=e<127?64:65,o=n<160?129:193;if((m(e,64,126)||m(e,128,252))&&(i=188*(n-o)+e-r),m(i,8836,10715))return 48508+i;var s=null===i?null:x(i,_("jis0208"));return null===s&&d(e)&&t.prepend(e),null===s?S(a):s}}function H(t){t.fatal;this.handler=function(t,e){if(e===b)return w;if(c(e)||128===e)return e;if(165===e)return 92;if(8254===e)return 126;if(m(e,65377,65439))return e-65377+161;8722===e&&(e=65293);var n,i=(n=e,(s=s||_("jis0208").map(function(t,e){return m(e,8272,8835)?null:t})).indexOf(n));if(null===i)return p(e);var r=l(i/188),o=i%188;return[r+(r<31?129:193),o+(o<63?64:65)]}}function N(t){var o=t.fatal,s=0;this.handler=function(t,e){if(e===b&&0!==s)return s=0,S(o);if(e===b&&0===s)return w;if(0===s)return d(e)?e:m(e,129,254)?(s=e,null):S(o);var n=s,i=null;s=0,m(e,65,254)&&(i=190*(n-129)+(e-65));var r=null===i?null:x(i,_("euc-kr"));return null===i&&d(e)&&t.prepend(e),null===r?S(o):r}}function L(t){t.fatal;this.handler=function(t,e){if(e===b)return w;if(c(e))return e;var n=v(e,_("euc-kr"));return null===n?p(e):[l(n/190)+129,n%190+65]}}function J(t,e){var n=t>>8,i=255&t;return e?[n,i]:[i,n]}function M(r,t){var o=t.fatal,s=null,a=null;this.handler=function(t,e){if(e===b&&(null!==s||null!==a))return S(o);if(e===b&&null===s&&null===a)return w;if(null===s)return s=e,null;var n;if(n=r?(s<<8)+e:(e<<8)+s,(s=null)===a)return m(n,55296,56319)?(a=n,null):m(n,56320,57343)?S(o):n;var i=a;return a=null,m(n,56320,57343)?65536+1024*(i-55296)+(n-56320):(t.prepend(J(n,r)),S(o))}}function F(r,t){t.fatal;this.handler=function(t,e){if(e===b)return w;if(m(e,0,65535))return J(e,r);var n=J(55296+(e-65536>>10),r),i=J(56320+(e-65536&1023),r);return n.concat(i)}}function X(t){t.fatal;this.handler=function(t,e){return e===b?w:d(e)?e:63360+e-128}}function q(t){t.fatal;this.handler=function(t,e){return e===b?w:c(e)?e:m(e,63360,63487)?e-63360+128:p(e)}}Object.defineProperty&&(Object.defineProperty(y.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),Object.defineProperty(y.prototype,"fatal",{get:function(){return"fatal"===this._error_mode}}),Object.defineProperty(y.prototype,"ignoreBOM",{get:function(){return this._ignoreBOM}})),y.prototype.decode=function(t,e){var n;n="object"==typeof t&&t instanceof ArrayBuffer?new Uint8Array(t):"object"==typeof t&&"buffer"in t&&t.buffer instanceof ArrayBuffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(0),e=a(e),this._do_not_flush||(this._decoder=g[this._encoding.name]({fatal:"fatal"===this._error_mode}),this._BOMseen=!1),this._do_not_flush=Boolean(e.stream);for(var i,r=new u(n),o=[];;){var s=r.read();if(s===b)break;if((i=this._decoder.handler(r,s))===w)break;null!==i&&(Array.isArray(i)?o.push.apply(o,i):o.push(i))}if(!this._do_not_flush){do{if((i=this._decoder.handler(r,r.read()))===w)break;null!==i&&(Array.isArray(i)?o.push.apply(o,i):o.push(i))}while(!r.endOfStream());this._decoder=null}return function(t){var e,n;return e=["UTF-8","UTF-16LE","UTF-16BE"],n=this._encoding.name,-1===e.indexOf(n)||this._ignoreBOM||this._BOMseen||(0<t.length&&65279===t[0]?(this._BOMseen=!0,t.shift()):0<t.length&&(this._BOMseen=!0)),function(t){for(var e="",n=0;n<t.length;++n){var i=t[n];i<=65535?e+=String.fromCharCode(i):(i-=65536,e+=String.fromCharCode(55296+(i>>10),56320+(1023&i)))}return e}(t)}.call(this,o)},Object.defineProperty&&Object.defineProperty(C.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),C.prototype.encode=function(t,e){t=void 0===t?"":String(t),e=a(e),this._do_not_flush||(this._encoder=f[this._encoding.name]({fatal:"fatal"===this._fatal})),this._do_not_flush=Boolean(e.stream);for(var n,i=new u(function(t){for(var e=String(t),n=e.length,i=0,r=[];i<n;){var o=e.charCodeAt(i);if(o<55296||57343<o)r.push(o);else if(56320<=o&&o<=57343)r.push(65533);else if(55296<=o&&o<=56319)if(i===n-1)r.push(65533);else{var s=e.charCodeAt(i+1);if(56320<=s&&s<=57343){var a=1023&o,l=1023&s;r.push(65536+(a<<10)+l),i+=1}else r.push(65533)}i+=1}return r}(t)),r=[];;){var o=i.read();if(o===b)break;if((n=this._encoder.handler(i,o))===w)break;Array.isArray(n)?r.push.apply(r,n):r.push(n)}if(!this._do_not_flush){for(;(n=this._encoder.handler(i,i.read()))!==w;)Array.isArray(n)?r.push.apply(r,n):r.push(n);this._encoder=null}return new Uint8Array(r)},f["UTF-8"]=function(t){return new A(t)},g["UTF-8"]=function(t){return new e(t)},"encoding-indexes"in i&&t.forEach(function(t){"Legacy single-byte encodings"===t.heading&&t.encodings.forEach(function(t){var e=t.name,n=_(e.toLowerCase());g[e]=function(t){return new I(n,t)},f[e]=function(t){return new O(n,t)}})}),g.GBK=function(t){return new R(t)},f.GBK=function(t){return new T(t,!0)},f.gb18030=function(t){return new T(t)},g.gb18030=function(t){return new R(t)},f.Big5=function(t){return new U(t)},g.Big5=function(t){return new E(t)},f["EUC-JP"]=function(t){return new D(t)},g["EUC-JP"]=function(t){return new j(t)},f["ISO-2022-JP"]=function(t){return new k(t)},g["ISO-2022-JP"]=function(t){return new B(t)},f.Shift_JIS=function(t){return new H(t)},g.Shift_JIS=function(t){return new P(t)},f["EUC-KR"]=function(t){return new L(t)},g["EUC-KR"]=function(t){return new N(t)},f["UTF-16BE"]=function(t){return new F(!0,t)},g["UTF-16BE"]=function(t){return new M(!0,t)},f["UTF-16LE"]=function(t){return new F(!1,t)},g["UTF-16LE"]=function(t){return new M(!1,t)},f["x-user-defined"]=function(t){return new q(t)},g["x-user-defined"]=function(t){return new X(t)},i.TextEncoder||(i.TextEncoder=C),i.TextDecoder||(i.TextDecoder=y),"undefined"!=typeof module&&module.exports&&(module.exports={TextEncoder:i.TextEncoder,TextDecoder:i.TextDecoder,EncodingIndexes:i["encoding-indexes"]})}(this||{});var CryptoJS=(CryptoJS=CryptoJS||function(u,t){var e={},n=e.lib={},i=n.Base=function(){function n(){}return{extend:function(t){n.prototype=this;var e=new n;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),d=n.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||o).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var s=n[o>>>2]>>>24-o%4*8&255;e[i+o>>>2]|=s<<24-(i+o)%4*8}else if(65535<n.length)for(o=0;o<r;o+=4)e[i+o>>>2]=n[o>>>2];else e.push.apply(e,n);return this.sigBytes+=r,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=u.ceil(e/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(4294967296*u.random()|0);return new d.init(e,t)}}),r=e.enc={},o=r.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var o=e[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new d.init(n,e/2)}},s=r.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var o=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new d.init(n,e)}},a=r.Utf8={stringify:function(t){try{return decodeURIComponent(escape(s.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return s.parse(unescape(encodeURIComponent(t)))}},l=(r.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],o=0;o<n;o+=3)for(var s=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)r.push(i.charAt(s>>>6*(3-a)&63));var l=i.charAt(64);if(l)for(;r.length%4;)r.push(l);return r.join("")},parse:function(t){var e=t.length,n=this._map,i=n.charAt(64);if(i){var r=t.indexOf(i);-1!=r&&(e=r)}for(var o=[],s=0,a=0;a<e;a++)if(a%4){var l=n.indexOf(t.charAt(a-1))<<a%4*2,c=n.indexOf(t.charAt(a))>>>6-a%4*2;o[s>>>2]|=(l|c)<<24-s%4*8,s++}return d.create(o,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},n.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=a.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,n=e.words,i=e.sigBytes,r=this.blockSize,o=i/(4*r),s=(o=t?u.ceil(o):u.max((0|o)-this._minBufferSize,0))*r,a=u.min(4*s,i);if(s){for(var l=0;l<s;l+=r)this._doProcessBlock(n,l);var c=n.splice(0,s);e.sigBytes-=a}return new d.init(c,a)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0})),c=n.Hasher=l.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,e){return new n.init(e).finalize(t)}},_createHmacHelper:function(n){return function(t,e){return new p.HMAC.init(n,e).finalize(t)}}}),p=e.algo={},h=[],f=p.SHA1=c.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],l=0;l<80;l++){if(l<16)h[l]=0|t[e+l];else{var c=h[l-3]^h[l-8]^h[l-14]^h[l-16];h[l]=c<<1|c>>>31}var u=(i<<5|i>>>27)+a+h[l];u+=l<20?1518500249+(r&o|~r&s):l<40?1859775393+(r^o^s):l<60?(r&o|r&s|o&s)-1894007588:(r^o^s)-899497514,a=s,s=o,o=r<<30|r>>>2,r=i,i=u}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=u.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=c.clone.call(this);return t._hash=this._hash.clone(),t}});return e.SHA1=c._createHelper(f),e.HmacSHA1=c._createHmacHelper(f),e}(Math))||function(a,t){var e={},n=e.lib={},i=function(){},r=n.Base={extend:function(t){i.prototype=this;var e=new i;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},l=n.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var r=0;r<t;r++)e[i+r>>>2]|=(n[r>>>2]>>>24-r%4*8&255)<<24-(i+r)%4*8;else if(65535<n.length)for(r=0;r<t;r+=4)e[i+r>>>2]=n[r>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=a.ceil(e/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(4294967296*a.random()|0);return new l.init(e,t)}}),o=e.enc={},s=o.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++){var r=e[i>>>2]>>>24-i%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new l.init(n,e/2)}},c=o.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++)n.push(String.fromCharCode(e[i>>>2]>>>24-i%4*8&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new l.init(n,e)}},u=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},d=n.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,n=e.words,i=e.sigBytes,r=this.blockSize,o=i/(4*r);if(t=(o=t?a.ceil(o):a.max((0|o)-this._minBufferSize,0))*r,i=a.min(4*t,i),t){for(var s=0;s<t;s+=r)this._doProcessBlock(n,s);s=n.splice(0,t),e.sigBytes-=i}return new l.init(s,i)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=d.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,e){return new n.init(e).finalize(t)}},_createHmacHelper:function(n){return function(t,e){return new p.HMAC.init(n,e).finalize(t)}}});var p=e.algo={};return e}(Math);!function(r){for(var t=CryptoJS,e=(i=t.lib).WordArray,n=i.Hasher,i=t.algo,o=[],f=[],s=function(t){return 4294967296*(t-(0|t))|0},a=2,l=0;l<64;){var c;t:{c=a;for(var u=r.sqrt(c),d=2;d<=u;d++)if(!(c%d)){c=!1;break t}c=!0}c&&(l<8&&(o[l]=s(r.pow(a,.5))),f[l]=s(r.pow(a,1/3)),l++),a++}var g=[];i=i.SHA256=n.extend({_doReset:function(){this._hash=new e.init(o.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],l=n[5],c=n[6],u=n[7],d=0;d<64;d++){if(d<16)g[d]=0|t[e+d];else{var p=g[d-15],h=g[d-2];g[d]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+g[d-7]+((h<<15|h>>>17)^(h<<13|h>>>19)^h>>>10)+g[d-16]}p=u+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&l^~a&c)+f[d]+g[d],h=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&o^r&o),u=c,c=l,l=a,a=s+p|0,s=o,o=r,r=i,i=p+h|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+u|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=r.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA256=n._createHelper(i),t.HmacSHA256=n._createHmacHelper(i)}(Math),function(){var t=CryptoJS,c=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=c.parse(e));var n=t.blockSize,i=4*n;e.sigBytes>i&&(e=t.finalize(e)),e.clamp();for(var r=this._oKey=e.clone(),o=this._iKey=e.clone(),s=r.words,a=o.words,l=0;l<n;l++)s[l]^=1549556828,a[l]^=909522486;r.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),(window.ADL=window.ADL||{}).activityTypes={assessment:"http://adlnet.gov/expapi/activities/assessment",attempt:"http://adlnet.gov/expapi/activities/attempt",course:"http://adlnet.gov/expapi/activities/course",file:"http://adlnet.gov/expapi/activities/file",interaction:"http://adlnet.gov/expapi/activities/interaction",lesson:"http://adlnet.gov/expapi/activities/lesson",link:"http://adlnet.gov/expapi/activities/link",media:"http://adlnet.gov/expapi/activities/media",meeting:"http://adlnet.gov/expapi/activities/meeting",module:"http://adlnet.gov/expapi/activities/module",objective:"http://adlnet.gov/expapi/activities/objective",performance:"http://adlnet.gov/expapi/activities/performance",profile:"http://adlnet.gov/expapi/activities/profile",question:"http://adlnet.gov/expapi/activities/question",simulation:"http://adlnet.gov/expapi/activities/simulation"},(window.ADL=window.ADL||{}).verbs={abandoned:{id:"https://w3id.org/xapi/adl/verbs/abandoned",display:{"en-US":"abandoned"}},answered:{id:"http://adlnet.gov/expapi/verbs/answered",display:{"de-DE":"beantwortete","en-US":"answered","fr-FR":"a répondu","es-ES":"contestó","ar-AR":"أجاب"}},asked:{id:"http://adlnet.gov/expapi/verbs/asked",display:{"de-DE":"fragte","en-US":"asked","fr-FR":"a demandé","es-ES":"preguntó","ar-AR":"طلب"}},attempted:{id:"http://adlnet.gov/expapi/verbs/attempted",display:{"de-DE":"versuchte","en-US":"attempted","fr-FR":"a essayé","es-ES":"intentó","ar-AR":"حاول"}},attended:{id:"http://adlnet.gov/expapi/verbs/attended",display:{"de-DE":"nahm teil an","en-US":"attended","fr-FR":"a suivi","es-ES":"asistió","ar-AR":"حضر"}},commented:{id:"http://adlnet.gov/expapi/verbs/commented",display:{"de-DE":"kommentierte","en-US":"commented","fr-FR":"a commenté","es-ES":"comentó","ar-AR":"علق"}},completed:{id:"http://adlnet.gov/expapi/verbs/completed",display:{"de-DE":"beendete","en-US":"completed","fr-FR":"a terminé","es-ES":"completó","ar-AR":"أكمل"}},exited:{id:"http://adlnet.gov/expapi/verbs/exited",display:{"de-DE":"verließ","en-US":"exited","fr-FR":"a quitté","es-ES":"salió","ar-AR":"خرج"}},experienced:{id:"http://adlnet.gov/expapi/verbs/experienced",display:{"de-DE":"erlebte","en-US":"experienced","fr-FR":"a éprouvé","es-ES":"experimentó","ar-AR":"شاهد"}},failed:{id:"http://adlnet.gov/expapi/verbs/failed",display:{"de-DE":"verfehlte","en-US":"failed","fr-FR":"a échoué","es-ES":"fracasó","ar-AR":"فشل"}},imported:{id:"http://adlnet.gov/expapi/verbs/imported",display:{"de-DE":"importierte","en-US":"imported","fr-FR":"a importé","es-ES":"importó","ar-AR":"مستورد"}},initialized:{id:"http://adlnet.gov/expapi/verbs/initialized",display:{"de-DE":"initialisierte","en-US":"initialized","fr-FR":"a initialisé","es-ES":"inicializó","ar-AR":"بدأ"}},interacted:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"de-DE":"interagierte","en-US":"interacted","fr-FR":"a interagi","es-ES":"interactuó","ar-AR":"تفاعل"}},launched:{id:"http://adlnet.gov/expapi/verbs/launched",display:{"de-DE":"startete","en-US":"launched","fr-FR":"a lancé","es-ES":"lanzó","ar-AR":"أطلق"}},mastered:{id:"http://adlnet.gov/expapi/verbs/mastered",display:{"de-DE":"meisterte","en-US":"mastered","fr-FR":"a maîtrisé","es-ES":"dominó","ar-AR":"أتقن"}},passed:{id:"http://adlnet.gov/expapi/verbs/passed",display:{"de-DE":"bestand","en-US":"passed","fr-FR":"a réussi","es-ES":"aprobó","ar-AR":"نجح"}},preferred:{id:"http://adlnet.gov/expapi/verbs/preferred",display:{"de-DE":"bevorzugte","en-US":"preferred","fr-FR":"a préféré","es-ES":"prefirió","ar-AR":"فضل"}},progressed:{id:"http://adlnet.gov/expapi/verbs/progressed",display:{"de-DE":"machte Fortschritt mit","en-US":"progressed","fr-FR":"a progressé","es-ES":"progresó","ar-AR":"تقدم"}},registered:{id:"http://adlnet.gov/expapi/verbs/registered",display:{"de-DE":"registrierte","en-US":"registered","fr-FR":"a enregistré","es-ES":"registró","ar-AR":"سجل"}},responded:{id:"http://adlnet.gov/expapi/verbs/responded",display:{"de-DE":"reagierte","en-US":"responded","fr-FR":"a répondu","es-ES":"respondió","ar-AR":"استجاب"}},resumed:{id:"http://adlnet.gov/expapi/verbs/resumed",display:{"de-DE":"setzte fort","en-US":"resumed","fr-FR":"a repris","es-ES":"continuó","ar-AR":"استأنف"}},satisfied:{id:"https://w3id.org/xapi/adl/verbs/satisfied",display:{"de-DE":"befriedigt","en-US":"satisfied","fr-FR":"satisfaite","es-ES":"satisfecho","ar-AR":"راض"}},scored:{id:"http://adlnet.gov/expapi/verbs/scored",display:{"de-DE":"erreichte","en-US":"scored","fr-FR":"a marqué","es-ES":"anotó","ar-AR":"سحل النقاط"}},shared:{id:"http://adlnet.gov/expapi/verbs/shared",display:{"de-DE":"teilte","en-US":"shared","fr-FR":"a partagé","es-ES":"compartió","ar-AR":"شارك"}},suspended:{id:"http://adlnet.gov/expapi/verbs/suspended",display:{"de-DE":"pausierte","en-US":"suspended","fr-FR":"a suspendu","es-ES":"aplazó","ar-AR":"علق"}},terminated:{id:"http://adlnet.gov/expapi/verbs/terminated",display:{"de-DE":"beendete","en-US":"terminated","fr-FR":"a terminé","es-ES":"terminó","ar-AR":"أنهى"}},voided:{id:"http://adlnet.gov/expapi/verbs/voided",display:{"de-DE":"entwertete","en-US":"voided","fr-FR":"a annulé","es-ES":"anuló","ar-AR":"فرغ"}},waived:{id:"https://w3id.org/xapi/adl/verbs/waived",display:{"de-DE":"verzichtet","en-US":"waived","fr-FR":"renoncé","es-ES":"renunciado","ar-AR":"تخلى"}}},function(b,w){function r(t){return CryptoJS&&CryptoJS.enc.Base64?CryptoJS.enc.Base64.stringify(CryptoJS.enc.Latin1.parse(t)):Base64.encode(t)}function c(t){if("[object ArrayBuffer]"!==Object.prototype.toString.call(t))return CryptoJS.SHA256(t).toString(CryptoJS.enc.Hex);for(var e=new Uint8Array(t),n=[],i=0;i<e.length;i+=4)n.push(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]);return CryptoJS.SHA256(CryptoJS.lib.WordArray.create(n,e.length)).toString(CryptoJS.enc.Hex)}function l(t){if("[object Date]"===Object.prototype.toString.call(t))var e=t;else e=new Date(t);return"[object Date]"===Object.prototype.toString.call(e)?isNaN(e.valueOf())?(b.XAPIWrapper.log("Invalid date String passed"),null):e:(b.XAPIWrapper.log("Invalid date object"),null)}Date.prototype.toISOString||function(){function t(t){var e=String(t);return 1===e.length&&(e="0"+e),e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(this.getUTCHours())+":"+t(this.getUTCMinutes())+":"+t(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(),d.debug=!1;var t,e=((t={endpoint:"http://localhost:8000/xapi/"}).auth="Basic "+r("tom:1234"),t),n=function(t,e){function n(t){var e=u(t);if(e.protocol&&e.host)return e.protocol+"//"+e.host;if(e.href){var n=e.href.split("//");return n[0]+"//"+n[1].substr(0,n[1].indexOf("/"))}b.XAPIWrapper.log("Couldn't create base url from endpoint: "+t)}function i(t,e,n){t.auth="Basic "+r(e+":"+n)}this.lrs=function(t){var e,n,i=["endpoint","auth","actor","registration","activity_id","grouping","activity_platform"],r=new Object;if(void 0!==(e=function(){var t,e,n,i,r;for(t=x.search.substr(1),e=t.split("&"),r={},i=0;i<e.length;i++)2===(n=e[i].split("=")).length&&n[0]&&(r[n[0]]=decodeURIComponent(n[1]));return r}())&&0!==Object.keys(e).length){for(var o=0;o<i.length;o++)e[n=i[o]]&&(r[n]=e[n],delete e[n]);0!==Object.keys(e).length&&(r.extended=e),r=a(t,r)}else r=t;return r}(t||{}),this.lrs.user&&this.lrs.password&&i(this.lrs,this.lrs.user,this.lrs.password),this.base=n(this.lrs.endpoint),this.withCredentials=!1,t&&void 0!==t.withCredentials&&(this.withCredentials=t.withCredentials),this.strictCallbacks=!1,this.strictCallbacks=t&&t.strictCallbacks,e&&o.call(this)&&b.XHR_request(this.lrs,this.lrs.endpoint+"about","GET",null,null,function(t){if(200==t.status)try{var e=JSON.parse(t.response),n=!1;for(var i in e.version)if(e.version.hasOwnProperty(i)&&e.version[i]==b.XAPIWrapper.xapiVersion){n=!0;break}n||b.XAPIWrapper.log("The lrs version ["+e.version+"] does not match this wrapper's XAPI version ["+b.XAPIWrapper.xapiVersion+"]")}catch(t){b.XAPIWrapper.log("The response was not an about object")}else b.XAPIWrapper.log("The request to get information about the LRS failed: "+t)},null,!1,null,this.withCredentials,!1),this.searchParams=function(){return{format:"exact"}},this.hash=function(t){if(!t)return null;try{return e=t,CryptoJS&&CryptoJS.SHA1?CryptoJS.SHA1(e).toString():Crypto.util.bytesToHex(Crypto.SHA1(e,{asBytes:!0}))}catch(t){return b.XAPIWrapper.log("Error trying to hash -- "+t),null}var e},this.changeConfig=function(t){try{b.XAPIWrapper.log("updating lrs object with new configuration"),this.lrs=a(this.lrs,t),t.user&&t.password&&this.updateAuth(this.lrs,t.user,t.password),this.base=n(this.lrs.endpoint),this.withCredentials=t.withCredentials,this.strictCallbacks=t.strictCallbacks}catch(t){b.XAPIWrapper.log("error while changing configuration -- "+t)}},this.updateAuth=i};function o(){try{return null!=this.lrs.endpoint&&""!=this.lrs.endpoint}catch(t){return!1}}function d(t){if(!d.debug)return!1;try{return console.log(t),!0}catch(t){return!1}}function a(e,n){for(var i in n)if(0!=n.hasOwnProperty(i)){d(i+" : "+n[i]);try{n[i].constructor==Object?e[i]=a(e[i],n[i]):(null==e&&(e=new Object),e[i]=n[i])}catch(t){null==e&&(e=new Object),e[i]=n[i]}}return e}n.prototype.xapiVersion="1.0.1",n.prototype.prepareStatement=function(t){void 0===t.actor?t.actor=JSON.parse(this.lrs.actor):"string"==typeof t.actor&&(t.actor=JSON.parse(t.actor)),(this.lrs.grouping||this.lrs.registration||this.lrs.activity_platform)&&(t.context||(t.context={})),this.lrs.grouping&&(t.context.contextActivities||(t.context.contextActivities={}),t.context.contextActivities.grouping=[{id:this.lrs.grouping}]),this.lrs.registration&&(t.context.registration=this.lrs.registration),this.lrs.activity_platform&&(t.context.platform=this.lrs.activity_platform)},n.prototype.testConfig=o,n.prototype.log=d,n.prototype.defaultEncoding="utf-8",n.prototype.sendStatement=function(t,e,n){if(this.testConfig()){var i;this.prepareStatement(t),t.id?i=t.id:(i=b.ruuid(),t.id=i);var r=JSON.stringify(t),o=null;n&&0<n.length&&(o={},r=this.buildMultipartPost(t,n,o));var s=b.XHR_request(this.lrs,this.lrs.endpoint+"statements","POST",r,this.lrs.auth,e,{id:i},null,o,this.withCredentials,this.strictCallbacks);if(!e)return{xhr:s,id:i}}},n.prototype.stringToArrayBuffer=function(t,e){return e=e||b.XAPIWrapper.defaultEncoding,new TextEncoder(e).encode(t).buffer},n.prototype.stringFromArrayBuffer=function(t,e){return e=e||b.XAPIWrapper.defaultEncoding,new TextDecoder(e).decode(t)},n.prototype.buildMultipartPost=function(t,e,n){t.attachments=[];for(var i=0;i<e.length;i++)"signature"==e[i].type&&(e[i].type={usageType:"http://adlnet.gov/expapi/attachments/signature",display:{"en-US":"A JWT signature"},description:{"en-US":"A signature proving the statement was not modified"},contentType:"application/octet-stream"}),"string"==typeof e[i].value&&(e[i].value=this.stringToArrayBuffer(e[i].value)),e[i].type.length=e[i].value.byteLength,e[i].type.sha2=c(e[i].value),t.attachments.push(e[i].type);var r=[],o=(Math.random()+" ").substring(2,10)+(Math.random()+" ").substring(2,10);n["Content-Type"]="multipart/mixed; boundary="+o;var s="\r\n",a=["--"+o,"Content-Type: application/json",'Content-Disposition: form-data; name="statement"',"",JSON.stringify(t)].join(s)+s;for(var i in r.push(a),e)if(e.hasOwnProperty(i)){var l=["--"+o,"Content-Type: "+e[i].type.contentType,"Content-Transfer-Encoding: binary","X-Experience-API-Hash: "+e[i].type.sha2].join(s)+s+s;r.push(l),r.push(e[i].value)}return r.push(s+"--"+o+"--"+s),new Blob(r)},n.prototype.sendStatements=function(t,e){if(this.testConfig()){for(var n in t)t.hasOwnProperty(n)&&this.prepareStatement(t[n]);var i=b.XHR_request(this.lrs,this.lrs.endpoint+"statements","POST",JSON.stringify(t),this.lrs.auth,e,null,!1,null,this.withCredentials,this.strictCallbacks);if(!e)return i}},n.prototype.getStatements=function(t,e,n){if(this.testConfig()){var i=this.lrs.endpoint+"statements";if(e)i=this.base+e;else{var r=new Array;for(s in t)if(t.hasOwnProperty(s))if("until"==s||"since"==s){var o=new Date(t[s]);r.push(s+"="+encodeURIComponent(o.toISOString()))}else r.push(s+"="+encodeURIComponent(t[s]));0<r.length&&(i=i+"?"+r.join("&"))}var a=b.XHR_request(this.lrs,i,"GET",null,this.lrs.auth,n,null,!1,null,this.withCredentials,this.strictCallbacks);if(void 0===a||404==a.status)return null;try{return JSON.parse(a.response)}catch(t){return a.response}}},n.prototype.getActivities=function(t,e){if(this.testConfig()){var n=this.lrs.endpoint+"activities?activityId=<activityid>";n=n.replace("<activityid>",encodeURIComponent(t));var i=b.XHR_request(this.lrs,n,"GET",null,this.lrs.auth,e,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===i||404==i.status)return null;try{return JSON.parse(i.response)}catch(t){return i.response}}},n.prototype.sendState=function(t,e,n,i,r,o,s,a){if(this.testConfig()){var l=this.lrs.endpoint+"activities/state?activityId=<activity ID>&agent=<agent>&stateId=<stateid>";l=(l=(l=l.replace("<activity ID>",encodeURIComponent(t))).replace("<agent>",encodeURIComponent(JSON.stringify(e)))).replace("<stateid>",encodeURIComponent(n)),i&&(l+="&registration="+encodeURIComponent(i));var c=null;o&&s?d("Can't have both If-Match and If-None-Match"):o?c={"If-Match":b.formatHash(o)}:s&&(c={"If-None-Match":b.formatHash(s)});var u="PUT";if(!r)return this.log("No activity state was included."),!1;r instanceof Array?(r=JSON.stringify(r),(c=c||{})["Content-Type"]="application/json"):r instanceof Object?(r=JSON.stringify(r),(c=c||{})["Content-Type"]="application/json",u="POST"):(c=c||{})["Content-Type"]="application/octet-stream",b.XHR_request(this.lrs,l,u,r,this.lrs.auth,a,null,null,c,this.withCredentials,this.strictCallbacks)}},n.prototype.getState=function(t,e,n,i,r,o){if(this.testConfig()){var s=this.lrs.endpoint+"activities/state?activityId=<activity ID>&agent=<agent>";s=(s=s.replace("<activity ID>",encodeURIComponent(t))).replace("<agent>",encodeURIComponent(JSON.stringify(e))),n&&(s+="&stateId="+encodeURIComponent(n)),i&&(s+="&registration="+encodeURIComponent(i)),r&&null!=(r=l(r))&&(s+="&since="+encodeURIComponent(r.toISOString()));var a=b.XHR_request(this.lrs,s,"GET",null,this.lrs.auth,o,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===a||404==a.status)return null;try{return JSON.parse(a.response)}catch(t){return a.response}}},n.prototype.deleteState=function(t,e,n,i,r,o,s){if(this.testConfig()){var a=this.lrs.endpoint+"activities/state?activityId=<activity ID>&agent=<agent>&stateId=<stateid>";a=(a=(a=a.replace("<activity ID>",encodeURIComponent(t))).replace("<agent>",encodeURIComponent(JSON.stringify(e)))).replace("<stateid>",encodeURIComponent(n)),i&&(a+="&registration="+encodeURIComponent(i));var l=null;r&&o?d("Can't have both If-Match and If-None-Match"):r?l={"If-Match":b.formatHash(r)}:o&&(l={"If-None-Match":b.formatHash(o)});var c=b.XHR_request(this.lrs,a,"DELETE",null,this.lrs.auth,s,null,!1,l,this.withCredentials,this.strictCallbacks);if(void 0===c||404==c.status)return null;try{return JSON.parse(c.response)}catch(t){return c}}},n.prototype.sendActivityProfile=function(t,e,n,i,r,o){if(this.testConfig()){var s=this.lrs.endpoint+"activities/profile?activityId=<activity ID>&profileId=<profileid>";s=(s=s.replace("<activity ID>",encodeURIComponent(t))).replace("<profileid>",encodeURIComponent(e));var a=null;i&&r?d("Can't have both If-Match and If-None-Match"):i?a={"If-Match":b.formatHash(i)}:r&&(a={"If-None-Match":b.formatHash(r)});var l="PUT";if(!n)return this.log("No activity profile was included."),!1;n instanceof Array?(n=JSON.stringify(n),(a=a||{})["Content-Type"]="application/json"):n instanceof Object?(n=JSON.stringify(n),(a=a||{})["Content-Type"]="application/json",l="POST"):(a=a||{})["Content-Type"]="application/octet-stream",b.XHR_request(this.lrs,s,l,n,this.lrs.auth,o,null,!1,a,this.withCredentials,this.strictCallbacks)}},n.prototype.getActivityProfile=function(t,e,n,i){if(this.testConfig()){var r=this.lrs.endpoint+"activities/profile?activityId=<activity ID>";r=r.replace("<activity ID>",encodeURIComponent(t)),e&&(r+="&profileId="+encodeURIComponent(e)),n&&null!=(n=l(n))&&(r+="&since="+encodeURIComponent(n.toISOString()));var o=b.XHR_request(this.lrs,r,"GET",null,this.lrs.auth,i,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===o||404==o.status)return null;try{return JSON.parse(o.response)}catch(t){return o.response}}},n.prototype.deleteActivityProfile=function(t,e,n,i,r){if(this.testConfig()){var o=this.lrs.endpoint+"activities/profile?activityId=<activity ID>&profileId=<profileid>";o=(o=o.replace("<activity ID>",encodeURIComponent(t))).replace("<profileid>",encodeURIComponent(e));var s=null;n&&i?d("Can't have both If-Match and If-None-Match"):n?s={"If-Match":b.formatHash(n)}:i&&(s={"If-None-Match":b.formatHash(i)});var a=b.XHR_request(this.lrs,o,"DELETE",null,this.lrs.auth,r,null,!1,s,this.withCredentials,this.strictCallbacks);if(void 0===a||404==a.status)return null;try{return JSON.parse(a.response)}catch(t){return a}}},n.prototype.getAgents=function(t,e){if(this.testConfig()){var n=this.lrs.endpoint+"agents?agent=<agent>";n=n.replace("<agent>",encodeURIComponent(JSON.stringify(t)));var i=b.XHR_request(this.lrs,n,"GET",null,this.lrs.auth,e,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===i||404==i.status)return null;try{return JSON.parse(i.response)}catch(t){return i.response}}},n.prototype.sendAgentProfile=function(t,e,n,i,r,o){if(this.testConfig()){var s=this.lrs.endpoint+"agents/profile?agent=<agent>&profileId=<profileid>";s=(s=s.replace("<agent>",encodeURIComponent(JSON.stringify(t)))).replace("<profileid>",encodeURIComponent(e));var a=null;i&&r?d("Can't have both If-Match and If-None-Match"):i?a={"If-Match":b.formatHash(i)}:r&&(a={"If-None-Match":b.formatHash(r)});var l="PUT";if(!n)return this.log("No agent profile was included."),!1;n instanceof Array?(n=JSON.stringify(n),(a=a||{})["Content-Type"]="application/json"):n instanceof Object?(n=JSON.stringify(n),(a=a||{})["Content-Type"]="application/json",l="POST"):(a=a||{})["Content-Type"]="application/octet-stream",b.XHR_request(this.lrs,s,l,n,this.lrs.auth,o,null,!1,a,this.withCredentials,this.strictCallbacks)}},n.prototype.getAgentProfile=function(t,e,n,i){if(this.testConfig()){var r=this.lrs.endpoint+"agents/profile?agent=<agent>";r=(r=r.replace("<agent>",encodeURIComponent(JSON.stringify(t)))).replace("<profileid>",encodeURIComponent(e)),e&&(r+="&profileId="+encodeURIComponent(e)),n&&null!=(n=l(n))&&(r+="&since="+encodeURIComponent(n.toISOString()));var o=b.XHR_request(this.lrs,r,"GET",null,this.lrs.auth,i,null,!0,null,this.withCredentials,this.strictCallbacks);if(void 0===o||404==o.status)return null;try{return JSON.parse(o.response)}catch(t){return o.response}}},n.prototype.deleteAgentProfile=function(t,e,n,i,r){if(this.testConfig()){var o=this.lrs.endpoint+"agents/profile?agent=<agent>&profileId=<profileid>";o=(o=o.replace("<agent>",encodeURIComponent(JSON.stringify(t)))).replace("<profileid>",encodeURIComponent(e));var s=null;n&&i?d("Can't have both If-Match and If-None-Match"):n?s={"If-Match":b.formatHash(n)}:i&&(s={"If-None-Match":b.formatHash(i)});var a=b.XHR_request(this.lrs,o,"DELETE",null,this.lrs.auth,r,null,!1,s,this.withCredentials,this.strictCallbacks);if(void 0===a||404==a.status)return null;try{return JSON.parse(a.response)}catch(t){return a}}};var S=Boolean(!w.document);if(S){var i=require("../node_modules/text-encoding/lib/encoding-indexes");global["encoding-indexes"]=i["encoding-indexes"]}var x=S?{search:"",protocol:"https:"}:w.location;function u(t){if(S)return require("url").parse(t);var e=document.createElement("a");return e.href=t,e}var _=w.XMLHttpRequest;function y(t,e,n,i,r,o){n=n||{},i=i||null;var s=void 0===(r=r||{}).async||r.async,a=void 0===r.withCredentials||r.withCredentials,l=e.toLowerCase().match(/^(.+):\/\/([^:\/]*):?(\d+)?(\/.*)?$/),c=x.protocol.toLowerCase()!==l[1]||x.hostname.toLowerCase()!==l[2];c||(c=(null===l[3]?"http"===l[1]?"80":"443":l[3])===x.port);var u,d=w.XDomainRequest&&_&&void 0===(new _).responseType,p=c&&!S&&d;if(p){var h=function(t,e,n,i){var r=e,o=new Array,s=r.indexOf("?");0<s&&(o.push(r.substr(s+1)),r=r.substr(0,s));if(r=r+"?method="+t,null!==n)for(var a in n)n.hasOwnProperty(a)&&o.push(a+"="+encodeURIComponent(n[a]));null!==i&&o.push("content="+encodeURIComponent(i));return{method:"POST",url:r,headers:{},data:o.join("&")}}(t,e,n,i);(u=new XDomainRequest).open(h.method,h.url)}else for(var f in(u=new _).withCredentials=a,u.open(t,e,s),n)u.setRequestHeader(f,n[f]);var g,v,y=!1;if(u.onload=u.onerror=u.onreadystatechange=function(){4===u.readyState&&(y||(y=!0,o&&o(u)))},u.send(p?h.data:i),!s&&p)for(var m=1e3+new Date;new Date<m&&4!==u.readyState&&!y;)g=void 0,g=new _,v=window.location+"?forcenocache="+b.ruuid(),g.open("GET",v,!1),g.send(null)}S&&((_=function(){this.method="GET",this.url=null,this.async=!0,this.headers={}}).prototype={open:function(t,e,n){if(!1===n)throw"ADL xAPIWrapper does not support synchronous http requests in node";this.method=t,this.url=e,this.withCredentials=!0,this.crossDomain=!0,this.responseText="",this.responseJSON=null,this.readyState=0,this.status=0,this.onreadystatechange=function(){},this.onerror=function(t){},this.onload=function(){}},setRequestHeader:function(t,e){this.headers[t]=e},send:function(t){var e=this.url.includes("https:")?require("https"):require("http"),n={method:this.method,headers:this.headers},i=u(this.url);for(var r in i)n[r]=i[r];var o=e.request(n,function(t){t.setEncoding("utf8"),this.status=t.statusCode,t.on("data",function(t){this.responseText+=t}.bind(this)),t.on("end",function(){this.readyState=4;try{this.responseJSON=JSON.parse(this.responseText)}catch(t){this.responseJSON=null}this.onload()}.bind(this))}.bind(this));o.on("error",function(t){this.readyState=4,this.onerror()}.bind(this)),o.end(t)}}),b.ruuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},b.dateFromISOString=function(t){var e=t.match(new RegExp("([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T| ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(.([0-9]+))?)?(Z|(([-+])([0-9]{2}):([0-9]{2})))?)?)?)?")),n=0,i=new Date(e[1],0,1);e[3]&&i.setMonth(e[3]-1),e[5]&&i.setDate(e[5]),e[7]&&i.setHours(e[7]),e[8]&&i.setMinutes(e[8]),e[10]&&i.setSeconds(e[10]),e[12]&&i.setMilliseconds(1e3*Number("0."+e[12])),e[14]&&(n=60*Number(e[16])+Number(e[17]),n*="-"==e[15]?1:-1),n-=i.getTimezoneOffset(),time=Number(i)+60*n*1e3;var r=new Date;return r.setTime(Number(time)),r},b.XHR_request=function(t,r,o,e,n,s,a,l,i,c,u){var d={"Content-Type":"application/json"};if(d.Authorization=n,d["X-Experience-API-Version"]=b.XAPIWrapper.xapiVersion,null!==i)for(var p in i){if(!i.hasOwnProperty(p))return;d[p]=i[p]}if(null!==t&&void 0!==t.extended){var h=new Array;for(var f in t.extended)h.push(f+"="+encodeURIComponent(t.extended[f]));0<h.length&&(r+=(-1<r.indexOf("?")?"&":"?")+h.join("&"))}var g,v=Boolean(s);return y(o,r,d,e,{async:v,withCredentials:c},function(e){var t=l&&404===e.status;if(!(void 0===e.status||200<=e.status&&e.status<400||t)){var n;try{n="There was a problem communicating with the Learning Record Store. ( "+e.status+" | "+e.response+" )"+r}catch(t){n=t.toString()}return b.XAPIWrapper.log(n),b.xhrRequestOnError(e,o,r,s,a,u),g=e}if(!s)return g=e;if(a)u?s(null,e,a):s(e,a);else{var i;try{i=JSON.parse(e.responseText)}catch(t){i=e.responseText}u?s(null,e,i):s(e,i)}}),g},b.xhrRequestOnError=function(e,t,n,i,r,o){if(i&&o){var s,a=e?e.status:void 0;if(s=a?new Error("Request error: "+e.status):0===a||null===a?new Error("Request error: aborted"):new Error("Reqeust error: unknown"),r)i(s,e,r);else{var l;try{l=JSON.parse(e.responseText)}catch(t){l=e.responseText}i(s,e,l)}}},b.formatHash=function(t){return"*"===t?t:'"'+t+'"'},b.XAPIWrapper=new n(e,!1)}(window.ADL=window.ADL||{},this),function(o){function r(t,e){var n=e.split("."),i=n[0];return e=n.slice(1).join("."),t[i]||(/\[\]$/.test(i)?t[i=i.slice(0,-2)]=[]:t[i]={}),e?r(t[i],e):t[i]}var i=function(t,e,n){if(t&&t.actor&&t.verb&&t.object){var i=t;for(var r in i)"actor"!=r&&"verb"!=r&&"object"!=r&&(this[r]=i[r]);t=i.actor,e=i.verb,n=i.object}t?t instanceof s?this.actor=t:"Agent"!==t.objectType&&t.objectType?"Group"===t.objectType&&(this.actor=new a(t)):this.actor=new s(t):this.actor=null,this.verb=e?e instanceof l?e:new l(e):null,n?"Activity"!==n.objectType&&n.objectType?"Agent"===n.objectType?this.object=n instanceof s?n:new s(n):"Group"===n.objectType?this.object=n instanceof a?n:new a(n):"StatementRef"===n.objectType?this.object=n instanceof u?n:new u(n):"SubStatement"===n.objectType?this.object=n instanceof d?n:new d(n):this.object=null:this.object=n instanceof c?n:new c(n):this.object=null,this.generateId=function(){this.id=o.ruuid()}};i.prototype.toString=function(){return this.actor.toString()+" "+this.verb.toString()+" "+this.object.toString()},i.prototype.isValid=function(){return this.actor&&this.actor.isValid()&&this.verb&&this.verb.isValid()&&this.object&&this.object.isValid()},i.prototype.generateRegistration=function(){r(this,"context").registration=o.ruuid()},i.prototype.addParentActivity=function(t){r(this,"context.contextActivities.parent[]").push(new c(t))},i.prototype.addGroupingActivity=function(t){r(this,"context.contextActivities.grouping[]").push(new c(t))},i.prototype.addOtherContextActivity=function(t){r(this,"context.contextActivities.other[]").push(new c(t))};var s=function(t,e){if(this.objectType="Agent",this.name=e,t&&(t.mbox||t.mbox_sha1sum||t.openid||t.account))for(var n in t)this[n]=t[n];else/^mailto:/.test(t)?this.mbox=t:/^[0-9a-f]{40}$/i.test(t)?this.mbox_sha1sum=t:/^http[s]?:/.test(t)?this.openid=t:t&&t.homePage&&t.name&&(this.account=t)};s.prototype.toString=function(){return this.name||this.mbox||this.openid||this.mbox_sha1sum||this.account.name},s.prototype.isValid=function(){return this.mbox||this.mbox_sha1sum||this.openid||this.account.homePage&&this.account.name||"Group"===this.objectType&&this.member};var a=function(t,e,n){s.call(this,t,n),this.member=e,this.objectType="Group"};a.prototype=new s;var l=function(t,e){if(t&&t.id)for(var n in t)this[n]=t[n];else this.id=t,e&&("string"==typeof e||e instanceof String?this.display={"en-US":e}:this.display=e)};l.prototype.toString=function(){return this.display&&(this.display["en-US"]||this.display.en)?this.display["en-US"]||this.display.en:this.id},l.prototype.isValid=function(){return this.id};var c=function(t,e,n){if(t&&t.id){var i=t;for(var r in i)this[r]=i[r]}else this.objectType="Activity",this.id=t,(e||n)&&(this.definition={},"string"==typeof e||e instanceof String?this.definition.name={"en-US":e}:e&&(this.definition.name=e),"string"==typeof n||n instanceof String?this.definition.description={"en-US":n}:n&&(this.definition.description=n))};c.prototype.toString=function(){return this.definition&&this.definition.name&&(this.definition.name["en-US"]||this.definition.name.en)?this.definition.name["en-US"]||this.definition.name.en:this.id},c.prototype.isValid=function(){return this.id&&(!this.objectType||"Activity"===this.objectType)};var u=function(t){if(t&&t.id)for(var e in t)this[e]=t[e];else this.objectType="StatementRef",this.id=t};u.prototype.toString=function(){return"statement("+this.id+")"},u.prototype.isValid=function(){return this.id&&this.objectType&&"StatementRef"===this.objectType};var d=function(t,e,n){i.call(this,t,e,n),this.objectType="SubStatement",delete this.id,delete this.stored,delete this.version,delete this.authority};d.prototype=new i,d.prototype.toString=function(){return'"'+d.prototype.prototype.toString.call(this)+'"'},i.Agent=s,i.Group=a,i.Verb=l,i.Activity=c,i.StatementRef=u,i.SubStatement=d,o.XAPIStatement=i}(window.ADL=window.ADL||{}),function(t){var a=t,e=!1;"undefined"!=typeof window&&(a=window.ADL=t.ADL||{},e=!0);var i=function(t){if("SubStatement"===t.objectType&&("SubStatement"!==t.object.objectType&&!(t.id||t.stored||t.version||t.authority)))return a.xapiutil.getActorId(t.actor)+":"+a.xapiutil.getVerbDisplay(t.verb)+":"+a.xapiutil.getObjectId(t.object)};a.xapiutil={},a.xapiutil.getLang=function(){var t;if("undefined"!=typeof navigator)t=navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage;else if("undefined"!=typeof process&&void 0!==process.env&&void 0!==process.env.LANG){var e=process.env.LANG;t=(t=e.slice(0,e.indexOf("."))).replace(/_/,"-")}return t||"en-US"},a.xapiutil.getLangVal=function(t){if(t&&0!=Object.keys(t).length){for(var e,n=a.xapiutil.getLang(),i=!1;t[n]?(e=t[n],i=!0):n.indexOf("-")&&(n=n.substring(0,n.lastIndexOf("-"))),!i&&""!==n;);return e}},a.xapiutil.getMoreStatements=function(i,r,o){if(!e)throw new Error("Node not supported.");var s=[];a.XAPIWrapper.getStatements(o,null,function t(e){if(e&&e.response){var n=JSON.parse(e.response);n.statements&&(s=s.concat(n.statements),i--<=0?r(s):n.more&&""!==n.more?a.XAPIWrapper.getStatements(o,n.more,t):""===n.more&&r(s))}})},a.xapiutil.getActorId=function(t){return t.mbox||t.openid||t.mbox_sha1sum||t.account},a.xapiutil.getActorIdString=function(t){var e=t.mbox||t.openid||t.mbox_sha1sum;return e||(e=t.account?t.account.homePage+":"+t.account.name:t.member?"Anon Group "+t.member:"unknown"),e},a.xapiutil.getActorDisplay=function(t){return t.name||a.xapiutil.getActorIdString(t)},a.xapiutil.getVerbDisplay=function(t){if(t)return t.display&&a.xapiutil.getLangVal(t.display)||t.id},a.xapiutil.getObjectType=function(t){return t.objectType||(t.id?"Activity":"Agent")},a.xapiutil.getObjectId=function(t){if(t.id)return t.id;var e=a.xapiutil.getObjectType(t);return"Agent"===e||"Group"===e?a.xapiutil.getActorId(t):void 0},a.xapiutil.getObjectIdString=function(t){if(!t)return"unknown";if(t.id)return t.id;var e=a.xapiutil.getObjectType(t);return"Agent"===e||"Group"===e?a.xapiutil.getActorIdString(t):"SubStatement"==e?i(t):"unknown"},a.xapiutil.getObjectDisplay=function(t){if(!t)return"unknown";var e=function(t){if(t.definition&&t.definition.name)return a.xapiutil.getLangVal(t.definition.name)}(t)||t.name||t.id;if(!e){var n=a.xapiutil.getObjectType(t);"Agent"===n||"Group"==n?e=a.xapiutil.getActorDisplay(t):"SubStatement"==n&&(e=i(t))}return e}}(this),function(d,t){function p(t){for(var e=window.location.search.substring(1).split("&"),n=0;n<e.length;n++){var i=e[n].split("=");if(decodeURIComponent(i[0])==t)return decodeURIComponent(i[1])}}function h(t){var e="xAPILaunchKey="+p("xAPILaunchKey")+"&xAPILaunchService="+p("xAPILaunchService");p("encrypted")&&(e+="&encrypted=true");for(var n=0;n<t.length;n++){var i=t[n],r=i.href,o=i.attributes.getNamedItem("courselink");o&&"true"==o.value&&(r=-1<r.indexOf("?")?r+"&"+e:r+"?"+e,i.href=r)}}var e=Boolean(!t.document);e||t.location;d.launch=function s(a,l,c){if(e)throw"ADL.launch not supported in node";var i;i=a,a=function(){var n=arguments;window.setTimeout(function(){for(var t=[],e=0;e<n.length;e++)t.push(n[e]);i.apply(window,t)},0)};try{var r=p("xAPILaunchKey"),o=p("xAPILaunchService");if(p("encrypted"),s.terminate=function(t){var e=new URL(o);e.pathname+="launch/"+r+"/terminate";var n=new XMLHttpRequest;n.withCredentials=!0,n.crossDomain=!0,n.open("POST",e.toString(),!1),n.setRequestHeader("Content-type","application/json"),n.send(JSON.stringify({code:0,description:t||"User closed content"}))},!r||!o)return a("invalid launch parameters");var t=new URL(o);t.pathname+="launch/"+r;var u=new XMLHttpRequest;u.withCredentials=!0,u.crossDomain=!0,u.onerror=function(t){window.setTimeout(function(){return a(t)})},u.onload=function(t){if(200!==u.status)return u.onerror(u.responseText);var e=JSON.parse(u.responseText),n=e,i={};i.endpoint=n.endpoint,i.actor=n.actor,i.withCredentials=!0,i.strictCallbacks=c||!1,window.onunload=function(){l&&s.terminate("User closed content")};var r,o=new d.XAPIWrapper.constructor;return o.changeConfig(i),h(document.body.querySelectorAll("a")),r=document.body,new MutationObserver(function(t){t.forEach(function(t){for(var e in t.addedNodes)t.addedNodes.hasOwnProperty(e)&&t.addedNodes[e].constructor==HTMLAnchorElement&&h([t.addedNodes[e]])})}).observe(r,{attributes:!0,childList:!0,subtree:!0}),a(null,e,o)},u.open("POST",t.toString(),!0),u.send()}catch(t){a(t)}}}(window.ADL=window.ADL||{},this);
//# sourceMappingURL=xapiwrapper.min.js.map
}));
